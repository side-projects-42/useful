{"version":3,"file":"index.js","sources":["../node_modules/typeson/dist/typeson-esm.js","../node_modules/base64-arraybuffer-es6/dist/base64-arraybuffer-es.js","../types/arraybuffer.js","../types/bigint-object.js","../types/bigint.js","../utils/stringArrayBuffer.js","../types/blob.js","../utils/generateUUID.js","../types/cloneable.js","../types/dataview.js","../types/date.js","../types/error.js","../types/errors.js","../types/file.js","../types/filelist.js","../types/imagebitmap.js","../types/imagedata.js","../types/infinity.js","../types/intl-types.js","../types/map.js","../types/nan.js","../types/negative-infinity.js","../types/nonbuiltin-ignore.js","../types/primitive-objects.js","../types/regexp.js","../types/resurrectable.js","../types/set.js","../types/typed-arrays-socketio.js","../types/typed-arrays.js","../types/undef.js","../types/user-object.js","../presets/array-nonindex-keys.js","../presets/special-numbers.js","../presets/builtin.js","../presets/postmessage.js","../presets/socketio.js","../presets/sparse-undefined.js","../presets/structured-cloning.js","../presets/structured-cloning-throwing.js","../presets/undef.js","../presets/universal.js","../index.js"],"sourcesContent":["function _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\n/**\n * We keep this function minimized so if using two instances of this\n *   library, where one is minimized and one is not, it will still work\n *   with `hasConstructorOf`.\n * With ES6 classes, we may be able to simply use `class TypesonPromise\n *   extends Promise` and add a string tag for detection\n * @param {function} f\n */\nvar TypesonPromise = function TypesonPromise(f) {\n  _classCallCheck(this, TypesonPromise);\n\n  this.p = new Promise(f);\n}; // eslint-disable-line block-spacing, space-before-function-paren, space-before-blocks, space-infix-ops, semi\n// class TypesonPromise extends Promise {get[Symbol.toStringTag](){return 'TypesonPromise'};} // eslint-disable-line keyword-spacing, space-before-function-paren, space-before-blocks, block-spacing, semi\n// Note: core-js-bundle provides a `Symbol` polyfill\n\n\nif (typeof Symbol !== 'undefined') {\n  // Ensure `isUserObject` will return `false` for `TypesonPromise`\n  TypesonPromise.prototype[Symbol.toStringTag] = 'TypesonPromise';\n}\n/**\n *\n * @param {function} [onFulfilled]\n * @param {function} [onRejected]\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.prototype.then = function (onFulfilled, onRejected) {\n  var _this = this;\n\n  return new TypesonPromise(function (typesonResolve, typesonReject) {\n    _this.p.then(function (res) {\n      typesonResolve(onFulfilled ? onFulfilled(res) : res);\n    }, function (r) {\n      _this.p['catch'](function (res) {\n        return onRejected ? onRejected(res) : Promise.reject(res);\n      }).then(typesonResolve, typesonReject);\n    });\n  });\n};\n/**\n *\n * @param {function} onRejected\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\n/**\n *\n * @param {} v\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.resolve = function (v) {\n  return new TypesonPromise(function (typesonResolve) {\n    typesonResolve(v);\n  });\n};\n/**\n *\n * @param {} v\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.reject = function (v) {\n  return new TypesonPromise(function (typesonResolve, typesonReject) {\n    typesonReject(v);\n  });\n};\n\n['all', 'race'].map(function (meth) {\n  /**\n   *\n   * @param {Promise[]} promArr\n   * @returns {TypesonPromise}\n   */\n  TypesonPromise[meth] = function (promArr) {\n    return new TypesonPromise(function (typesonResolve, typesonReject) {\n      Promise[meth](promArr.map(function (prom) {\n        return prom.p;\n      })).then(typesonResolve, typesonReject);\n    });\n  };\n});\n\nvar _ref = {},\n    toString = _ref.toString,\n    hasOwn = {}.hasOwnProperty,\n    getProto = Object.getPrototypeOf,\n    fnToString = hasOwn.toString;\n/**\n *\n * @param {*} v\n * @param {boolean} catchCheck\n * @returns {boolean}\n */\n\nfunction isThenable(v, catchCheck) {\n  return isObject(v) && typeof v.then === 'function' && (!catchCheck || typeof v[\"catch\"] === 'function');\n}\n/**\n *\n * @param {*} val\n * @returns {string}\n */\n\n\nfunction toStringTag(val) {\n  return toString.call(val).slice(8, -1);\n}\n/**\n * This function is dependent on both constructors\n *   being identical so any minimization is expected of both.\n * @param {*} a\n * @param {function} b\n * @returns {boolean}\n */\n\n\nfunction hasConstructorOf(a, b) {\n  if (!a || _typeof(a) !== 'object') {\n    return false;\n  }\n\n  var proto = getProto(a);\n\n  if (!proto) {\n    return false;\n  }\n\n  var Ctor = hasOwn.call(proto, 'constructor') && proto.constructor;\n\n  if (typeof Ctor !== 'function') {\n    return b === null;\n  }\n\n  return typeof Ctor === 'function' && b !== null && fnToString.call(Ctor) === fnToString.call(b);\n}\n/**\n *\n * @param {*} val\n * @returns {boolean}\n */\n\n\nfunction isPlainObject(val) {\n  // Mirrors jQuery's\n  if (!val || toStringTag(val) !== 'Object') {\n    return false;\n  }\n\n  var proto = getProto(val);\n\n  if (!proto) {\n    // `Object.create(null)`\n    return true;\n  }\n\n  return hasConstructorOf(val, Object);\n}\n/**\n *\n * @param {*} val\n * @returns {boolean}\n */\n\n\nfunction isUserObject(val) {\n  if (!val || toStringTag(val) !== 'Object') {\n    return false;\n  }\n\n  var proto = getProto(val);\n\n  if (!proto) {\n    // `Object.create(null)`\n    return true;\n  }\n\n  return hasConstructorOf(val, Object) || isUserObject(proto);\n}\n/**\n *\n * @param {*} v\n * @returns {boolean}\n */\n\n\nfunction isObject(v) {\n  return v && _typeof(v) === 'object';\n}\n/**\n *\n * @param {string} keyPathComponent\n * @returns {string}\n */\n\n\nfunction escapeKeyPathComponent(keyPathComponent) {\n  return keyPathComponent.replace(/~/g, '~0').replace(/\\./g, '~1');\n}\n/**\n *\n * @param {string} keyPathComponent\n * @returns {string}\n */\n\n\nfunction unescapeKeyPathComponent(keyPathComponent) {\n  return keyPathComponent.replace(/~1/g, '.').replace(/~0/g, '~');\n}\n/**\n * @param {object|array} obj\n * @param {string} keyPath\n * @returns {*}\n */\n\n\nfunction getByKeyPath(obj, keyPath) {\n  if (keyPath === '') {\n    return obj;\n  }\n\n  var period = keyPath.indexOf('.');\n\n  if (period > -1) {\n    var innerObj = obj[unescapeKeyPathComponent(keyPath.substr(0, period))];\n    return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n  }\n\n  return obj[unescapeKeyPathComponent(keyPath)];\n}\n\nfunction setAtKeyPath(obj, keyPath, value) {\n  if (keyPath === '') {\n    return value;\n  }\n\n  var period = keyPath.indexOf('.');\n\n  if (period > -1) {\n    var innerObj = obj[unescapeKeyPathComponent(keyPath.substr(0, period))];\n    return setAtKeyPath(innerObj, keyPath.substr(period + 1), value);\n  }\n\n  obj[unescapeKeyPathComponent(keyPath)] = value;\n  return obj;\n}\n/**\n *\n * @param {external:JSON} value\n * @returns {\"null\"|\"array\"|\"undefined\"|\"boolean\"|\"number\"|\"string\"|\"object\"|\"symbol\"}\n */\n\n\nfunction getJSONType(value) {\n  return value === null ? 'null' : Array.isArray(value) ? 'array' : _typeof(value);\n}\n\nvar keys = Object.keys,\n    isArray = Array.isArray,\n    hasOwn$1 = {}.hasOwnProperty,\n    internalStateObjPropsToIgnore = ['type', 'replaced', 'iterateIn', 'iterateUnsetNumeric'];\n\nfunction nestedPathsFirst(a, b) {\n  var as = a.keypath.match(/\\./g);\n  var bs = a.keypath.match(/\\./g);\n\n  if (as) {\n    as = as.length;\n  }\n\n  if (bs) {\n    bs = bs.length;\n  }\n\n  return as > bs ? -1 : as < bs ? 1 : a.keypath < b.keypath ? -1 : a.keypath > b.keypath;\n}\n/**\n * An instance of this class can be used to call `stringify()` and `parse()`.\n * Typeson resolves cyclic references by default. Can also be extended to\n * support custom types using the register() method.\n *\n * @constructor\n * @param {{cyclic: boolean}} [options] - if cyclic (default true),\n *   cyclic references will be handled gracefully.\n */\n\n\nvar Typeson =\n/*#__PURE__*/\nfunction () {\n  function Typeson(options) {\n    _classCallCheck(this, Typeson);\n\n    this.options = options; // Replacers signature: replace (value). Returns falsy if not\n    //   replacing. Otherwise ['Date', value.getTime()]\n\n    this.plainObjectReplacers = [];\n    this.nonplainObjectReplacers = []; // Revivers: [{type => reviver}, {plain: boolean}].\n    //   Sample: [{'Date': value => new Date(value)}, {plain: false}]\n\n    this.revivers = {};\n    /** Types registered via register() */\n\n    this.types = {};\n  }\n  /**\n   * Serialize given object to Typeson.\n   * Initial arguments work identical to those of `JSON.stringify`.\n   * The `replacer` argument has nothing to do with our replacers.\n   * @param {*} obj\n   * @param {function|string[]} replacer\n   * @param {number|string} space\n   * @param {object} opts\n   * @returns {string|Promise} Promise resolves to a string\n   */\n\n\n  _createClass(Typeson, [{\n    key: \"stringify\",\n    value: function stringify(obj, replacer, space, opts) {\n      opts = _objectSpread({}, this.options, opts, {\n        stringification: true\n      });\n      var encapsulated = this.encapsulate(obj, null, opts);\n\n      if (isArray(encapsulated)) {\n        return JSON.stringify(encapsulated[0], replacer, space);\n      }\n\n      return encapsulated.then(function (res) {\n        return JSON.stringify(res, replacer, space);\n      });\n    }\n    /**\n     * Also sync but throws on non-sync result\n     * @param {*} obj\n     * @param {function|string[]} replacer\n     * @param {number|string} space\n     * @param {object} opts\n     * @returns {string}\n     */\n\n  }, {\n    key: \"stringifySync\",\n    value: function stringifySync(obj, replacer, space, opts) {\n      return this.stringify(obj, replacer, space, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: true\n      }));\n    }\n    /**\n     *\n     * @param {*} obj\n     * @param {function|string[]} replacer\n     * @param {number|string} space\n     * @param {object} opts\n     * @returns {Promise} Resolves to string\n     */\n\n  }, {\n    key: \"stringifyAsync\",\n    value: function stringifyAsync(obj, replacer, space, opts) {\n      return this.stringify(obj, replacer, space, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: false\n      }));\n    }\n    /**\n     * Parse Typeson back into an obejct.\n     * Initial arguments works identical to those of `JSON.parse()`.\n     * @param {string} text\n     * @param {function} reviver This JSON reviver has nothing to do with\n     *   our revivers.\n     * @param {object} opts\n     * @returns {external:JSON}\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(text, reviver, opts) {\n      opts = _objectSpread({}, this.options, opts, {\n        parse: true\n      });\n      return this.revive(JSON.parse(text, reviver), opts);\n    }\n    /**\n    * Also sync but throws on non-sync result\n    * @param {string} text\n    * @param {function} reviver This JSON reviver has nothing to do with\n    *   our revivers.\n    * @param {object} opts\n    * @returns {external:JSON}\n    */\n\n  }, {\n    key: \"parseSync\",\n    value: function parseSync(text, reviver, opts) {\n      return this.parse(text, reviver, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: true\n      }));\n    }\n    /**\n    * @param {string} text\n    * @param {function} reviver This JSON reviver has nothing to do with\n    *   our revivers.\n    * @param {object} opts\n    * @returns {Promise} Resolves to `external:JSON`\n    */\n\n  }, {\n    key: \"parseAsync\",\n    value: function parseAsync(text, reviver, opts) {\n      return this.parse(text, reviver, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: false\n      }));\n    }\n    /**\n     *\n     * @param {*} obj\n     * @param {object} stateObj\n     * @param {object} [opts={}]\n     * @returns {string[]|false}\n     */\n\n  }, {\n    key: \"specialTypeNames\",\n    value: function specialTypeNames(obj, stateObj) {\n      var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      opts.returnTypeNames = true;\n      return this.encapsulate(obj, stateObj, opts);\n    }\n    /**\n     *\n     * @param {*} obj\n     * @param {object} stateObj\n     * @param {object} [opts={}]\n     * @returns {Promise|Array|object|string|false}\n     */\n\n  }, {\n    key: \"rootTypeName\",\n    value: function rootTypeName(obj, stateObj) {\n      var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      opts.iterateNone = true;\n      return this.encapsulate(obj, stateObj, opts);\n    }\n    /**\n     * Encapsulate a complex object into a plain Object by replacing\n     * registered types with plain objects representing the types data.\n     *\n     * This method is used internally by T`ypeson.stringify()`.\n     * @param {Object} obj - Object to encapsulate.\n     * @param {object} stateObj\n     * @param {object} opts\n     * @returns {Promise|Array|object|string|false}\n     */\n\n  }, {\n    key: \"encapsulate\",\n    value: function encapsulate(obj, stateObj, opts) {\n      opts = _objectSpread({\n        sync: true\n      }, this.options, opts);\n      var _opts = opts,\n          sync = _opts.sync;\n      var that = this,\n          types = {},\n          refObjs = [],\n          // For checking cyclic references\n      refKeys = [],\n          // For checking cyclic references\n      promisesDataRoot = []; // Clone the object deeply while at the same time replacing any\n      //   special types or cyclic reference:\n\n      var cyclic = 'cyclic' in opts ? opts.cyclic : true;\n      var _opts2 = opts,\n          encapsulateObserver = _opts2.encapsulateObserver;\n\n      var ret = _encapsulate('', obj, cyclic, stateObj || {}, promisesDataRoot);\n      /**\n       *\n       * @param {*} ret\n       * @returns {Array|object|string|false}\n       */\n\n\n      function finish(ret) {\n        // Add `$types` to result only if we ever bumped into a\n        //  special type (or special case where object has own `$types`)\n        var typeNames = Object.values(types);\n\n        if (opts.iterateNone) {\n          if (typeNames.length) {\n            return typeNames[0];\n          }\n\n          return Typeson.getJSONType(ret);\n        }\n\n        if (typeNames.length) {\n          if (opts.returnTypeNames) {\n            return _toConsumableArray(new Set(typeNames));\n          } // Special if array (or a primitive) was serialized\n          //   because JSON would ignore custom `$types` prop on it\n\n\n          if (!ret || !isPlainObject(ret) || // Also need to handle if this is an object with its\n          //   own `$types` property (to avoid ambiguity)\n          hasOwn$1.call(ret, '$types')) {\n            ret = {\n              $: ret,\n              $types: {\n                $: types\n              }\n            };\n          } else {\n            ret.$types = types;\n          } // No special types\n\n        } else if (isObject(ret) && hasOwn$1.call(ret, '$types')) {\n          ret = {\n            $: ret,\n            $types: true\n          };\n        }\n\n        if (opts.returnTypeNames) {\n          return false;\n        }\n\n        return ret;\n      }\n      /**\n       *\n       * @param {*} ret\n       * @param {array} promisesData\n       * @returns {Promise} Resolves to ...\n       */\n\n\n      function checkPromises(_x, _x2) {\n        return _checkPromises.apply(this, arguments);\n      }\n      /**\n       *\n       * @param {object} stateObj\n       * @param {object} ownKeysObj\n       * @param {function} cb\n       * @returns {undefined}\n       */\n\n\n      function _checkPromises() {\n        _checkPromises = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee2(ret, promisesData) {\n          var promResults;\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return Promise.all(promisesData.map(function (pd) {\n                    return pd[1].p;\n                  }));\n\n                case 2:\n                  promResults = _context2.sent;\n                  _context2.next = 5;\n                  return Promise.all(promResults.map(\n                  /*#__PURE__*/\n                  function () {\n                    var _ref = _asyncToGenerator(\n                    /*#__PURE__*/\n                    regeneratorRuntime.mark(function _callee(promResult) {\n                      var newPromisesData, _promisesData$splice, _promisesData$splice2, prData, _prData, keyPath, cyclic, stateObj, parentObj, key, detectedType, encaps, isTypesonPromise, encaps2;\n\n                      return regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              newPromisesData = [];\n                              _promisesData$splice = promisesData.splice(0, 1), _promisesData$splice2 = _slicedToArray(_promisesData$splice, 1), prData = _promisesData$splice2[0];\n                              _prData = _slicedToArray(prData, 7), keyPath = _prData[0], cyclic = _prData[2], stateObj = _prData[3], parentObj = _prData[4], key = _prData[5], detectedType = _prData[6];\n                              encaps = _encapsulate(keyPath, promResult, cyclic, stateObj, newPromisesData, true, detectedType);\n                              isTypesonPromise = hasConstructorOf(encaps, TypesonPromise); // Handle case where an embedded custom type itself\n                              //   returns a `Typeson.Promise`\n\n                              if (!(keyPath && isTypesonPromise)) {\n                                _context.next = 11;\n                                break;\n                              }\n\n                              _context.next = 8;\n                              return encaps.p;\n\n                            case 8:\n                              encaps2 = _context.sent;\n                              parentObj[key] = encaps2;\n                              return _context.abrupt(\"return\", checkPromises(ret, newPromisesData));\n\n                            case 11:\n                              if (keyPath) {\n                                parentObj[key] = encaps;\n                              } else if (isTypesonPromise) {\n                                ret = encaps.p;\n                              } else {\n                                // If this is itself a `Typeson.Promise` (because the\n                                //   original value supplied was a `Promise` or\n                                //   because the supplied custom type value resolved\n                                //   to one), returning it below will be fine since\n                                //   a `Promise` is expected anyways given current\n                                //   config (and if not a `Promise`, it will be ready\n                                //   as the resolve value)\n                                ret = encaps;\n                              }\n\n                              return _context.abrupt(\"return\", checkPromises(ret, newPromisesData));\n\n                            case 13:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee);\n                    }));\n\n                    return function (_x3) {\n                      return _ref.apply(this, arguments);\n                    };\n                  }()));\n\n                case 5:\n                  return _context2.abrupt(\"return\", ret);\n\n                case 6:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n        return _checkPromises.apply(this, arguments);\n      }\n\n      function _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, cb) {\n        Object.assign(stateObj, ownKeysObj);\n        var vals = internalStateObjPropsToIgnore.map(function (prop) {\n          var tmp = stateObj[prop];\n          delete stateObj[prop];\n          return tmp;\n        });\n        cb();\n        internalStateObjPropsToIgnore.forEach(function (prop, i) {\n          stateObj[prop] = vals[i];\n        });\n      }\n      /**\n       *\n       * @param {string} keypath\n       * @param {*} value\n       * @param {boolean} cyclic\n       * @param {object} stateObj\n       * @param {boolean} promisesData\n       * @param {boolean} resolvingTypesonPromise\n       * @param {string} detectedType\n       * @returns {*}\n       */\n\n\n      function _encapsulate(keypath, value, cyclic, stateObj, promisesData, resolvingTypesonPromise, detectedType) {\n        var ret;\n        var observerData = {};\n\n        var $typeof = _typeof(value);\n\n        var runObserver = encapsulateObserver ? function (obj) {\n          var type = detectedType || stateObj.type || Typeson.getJSONType(value);\n          encapsulateObserver(Object.assign(obj || observerData, {\n            keypath: keypath,\n            value: value,\n            cyclic: cyclic,\n            stateObj: stateObj,\n            promisesData: promisesData,\n            resolvingTypesonPromise: resolvingTypesonPromise,\n            awaitingTypesonPromise: hasConstructorOf(value, TypesonPromise)\n          }, type !== undefined ? {\n            type: type\n          } : {}));\n        } : null;\n\n        if (['string', 'boolean', 'number', 'undefined'].includes($typeof)) {\n          if (value === undefined || $typeof === 'number' && (isNaN(value) || value === -Infinity || value === Infinity)) {\n            ret = replace(keypath, value, stateObj, promisesData, false, resolvingTypesonPromise, runObserver);\n\n            if (ret !== value) {\n              observerData = {\n                replaced: ret\n              };\n            }\n          } else {\n            ret = value;\n          }\n\n          if (runObserver) {\n            runObserver();\n          }\n\n          return ret;\n        }\n\n        if (value === null) {\n          if (runObserver) {\n            runObserver();\n          }\n\n          return value;\n        }\n\n        if (cyclic && !stateObj.iterateIn && !stateObj.iterateUnsetNumeric) {\n          // Options set to detect cyclic references and be able\n          //   to rewrite them.\n          var refIndex = refObjs.indexOf(value);\n\n          if (refIndex < 0) {\n            if (cyclic === true) {\n              refObjs.push(value);\n              refKeys.push(keypath);\n            }\n          } else {\n            types[keypath] = '#';\n\n            if (runObserver) {\n              runObserver({\n                cyclicKeypath: refKeys[refIndex]\n              });\n            }\n\n            return '#' + refKeys[refIndex];\n          }\n        }\n\n        var isPlainObj = isPlainObject(value);\n        var isArr = isArray(value);\n        var replaced = // Running replace will cause infinite loop as will test\n        //   positive again\n        (isPlainObj || isArr) && (!that.plainObjectReplacers.length || stateObj.replaced) || stateObj.iterateIn ? // Optimization: if plain object and no plain-object\n        //   replacers, don't try finding a replacer\n        value : replace(keypath, value, stateObj, promisesData, isPlainObj || isArr, null, runObserver);\n        var clone;\n\n        if (replaced !== value) {\n          ret = replaced;\n          observerData = {\n            replaced: replaced\n          };\n        } else {\n          if (isArr && stateObj.iterateIn !== 'object' || stateObj.iterateIn === 'array') {\n            clone = new Array(value.length);\n            observerData = {\n              clone: clone\n            };\n          } else if (isPlainObj || stateObj.iterateIn === 'object') {\n            clone = {};\n\n            if (stateObj.addLength) {\n              clone.length = value.length;\n            }\n\n            observerData = {\n              clone: clone\n            };\n          } else if (keypath === '' && hasConstructorOf(value, TypesonPromise)) {\n            promisesData.push([keypath, value, cyclic, stateObj, undefined, undefined, stateObj.type]);\n            ret = value;\n          } else {\n            ret = value; // Only clone vanilla objects and arrays\n          }\n        }\n\n        if (runObserver) {\n          runObserver();\n        }\n\n        if (opts.iterateNone) {\n          return clone || ret;\n        }\n\n        if (!clone) {\n          return ret;\n        } // Iterate object or array\n\n\n        if (stateObj.iterateIn) {\n          var _loop = function _loop(key) {\n            var ownKeysObj = {\n              ownKeys: hasOwn$1.call(value, key)\n            };\n\n            _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n              var kp = keypath + (keypath ? '.' : '') + escapeKeyPathComponent(key);\n\n              var val = _encapsulate(kp, value[key], !!cyclic, stateObj, promisesData, resolvingTypesonPromise);\n\n              if (hasConstructorOf(val, TypesonPromise)) {\n                promisesData.push([kp, val, !!cyclic, stateObj, clone, key, stateObj.type]);\n              } else if (val !== undefined) {\n                clone[key] = val;\n              }\n            });\n          };\n\n          for (var key in value) {\n            _loop(key);\n          }\n\n          if (runObserver) {\n            runObserver({\n              endIterateIn: true,\n              end: true\n            });\n          }\n        } else {\n          // Note: Non-indexes on arrays won't survive stringify so\n          //  somewhat wasteful for arrays, but so too is iterating\n          //  all numeric indexes on sparse arrays when not wanted\n          //  or filtering own keys for positive integers\n          keys(value).forEach(function (key) {\n            var kp = keypath + (keypath ? '.' : '') + escapeKeyPathComponent(key);\n            var ownKeysObj = {\n              ownKeys: true\n            };\n\n            _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n              var val = _encapsulate(kp, value[key], !!cyclic, stateObj, promisesData, resolvingTypesonPromise);\n\n              if (hasConstructorOf(val, TypesonPromise)) {\n                promisesData.push([kp, val, !!cyclic, stateObj, clone, key, stateObj.type]);\n              } else if (val !== undefined) {\n                clone[key] = val;\n              }\n            });\n          });\n\n          if (runObserver) {\n            runObserver({\n              endIterateOwn: true,\n              end: true\n            });\n          }\n        } // Iterate array for non-own numeric properties (we can't\n        //   replace the prior loop though as it iterates non-integer\n        //   keys)\n\n\n        if (stateObj.iterateUnsetNumeric) {\n          var vl = value.length;\n\n          var _loop2 = function _loop2(i) {\n            if (!(i in value)) {\n              // No need to escape numeric\n              var kp = keypath + (keypath ? '.' : '') + i;\n              var ownKeysObj = {\n                ownKeys: false\n              };\n\n              _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n                var val = _encapsulate(kp, undefined, !!cyclic, stateObj, promisesData, resolvingTypesonPromise);\n\n                if (hasConstructorOf(val, TypesonPromise)) {\n                  promisesData.push([kp, val, !!cyclic, stateObj, clone, i, stateObj.type]);\n                } else if (val !== undefined) {\n                  clone[i] = val;\n                }\n              });\n            }\n          };\n\n          for (var i = 0; i < vl; i++) {\n            _loop2(i);\n          }\n\n          if (runObserver) {\n            runObserver({\n              endIterateUnsetNumeric: true,\n              end: true\n            });\n          }\n        }\n\n        return clone;\n      }\n      /**\n       *\n       * @param {string} keypath\n       * @param {*} value\n       * @param {object} stateObj\n       * @param {array} promisesData\n       * @param {boolean} plainObject\n       * @param {boolean} resolvingTypesonPromise\n       * @param {function} [runObserver]\n       * @returns {*}\n       */\n\n\n      function replace(keypath, value, stateObj, promisesData, plainObject, resolvingTypesonPromise, runObserver) {\n        // Encapsulate registered types\n        var replacers = plainObject ? that.plainObjectReplacers : that.nonplainObjectReplacers;\n        var i = replacers.length;\n\n        while (i--) {\n          var replacer = replacers[i];\n\n          if (replacer.test(value, stateObj)) {\n            var type = replacer.type;\n\n            if (that.revivers[type]) {\n              // Record the type only if a corresponding reviver\n              //   exists. This is to support specs where only\n              //   replacement is done.\n              // For example, ensuring deep cloning of the object,\n              //   or replacing a type to its equivalent without\n              //   the need to revive it.\n              var existing = types[keypath]; // type can comprise an array of types (see test\n              //   `shouldSupportIntermediateTypes`)\n\n              types[keypath] = existing ? [type].concat(existing) : type;\n            } // Now, also traverse the result in case it contains its\n            //   own types to replace\n\n\n            Object.assign(stateObj, {\n              type: type,\n              replaced: true\n            });\n\n            if ((sync || !replacer.replaceAsync) && !replacer.replace) {\n              if (runObserver) {\n                runObserver({\n                  typeDetected: true\n                });\n              }\n\n              return _encapsulate(keypath, value, cyclic && 'readonly', stateObj, promisesData, resolvingTypesonPromise, type);\n            }\n\n            if (runObserver) {\n              runObserver({\n                replacing: true\n              });\n            }\n\n            var replaceMethod = sync || !replacer.replaceAsync ? 'replace' : 'replaceAsync';\n            return _encapsulate(keypath, replacer[replaceMethod](value, stateObj), cyclic && 'readonly', stateObj, promisesData, resolvingTypesonPromise, type);\n          }\n        }\n\n        return value;\n      }\n\n      return promisesDataRoot.length ? sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Sync method requested but async result obtained');\n      }() : Promise.resolve(checkPromises(ret, promisesDataRoot)).then(finish) : !sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Async method requested but sync result obtained');\n      }() // If this is a synchronous request for stringification, yet\n      //   a promise is the result, we don't want to resolve leading\n      //   to an async result, so we return an array to avoid\n      //   ambiguity\n      : opts.stringification && sync ? [finish(ret)] : sync ? finish(ret) : Promise.resolve(finish(ret));\n    }\n    /**\n     * Also sync but throws on non-sync result\n     * @param {*} obj\n     * @param {object} stateObj\n     * @param {object} opts\n     * @returns {*}\n     */\n\n  }, {\n    key: \"encapsulateSync\",\n    value: function encapsulateSync(obj, stateObj, opts) {\n      return this.encapsulate(obj, stateObj, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: true\n      }));\n    }\n    /**\n     * @param {*} obj\n     * @param {object} stateObj\n     * @param {object} opts\n     * @returns {*}\n     */\n\n  }, {\n    key: \"encapsulateAsync\",\n    value: function encapsulateAsync(obj, stateObj, opts) {\n      return this.encapsulate(obj, stateObj, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: false\n      }));\n    }\n    /**\n     * Revive an encapsulated object.\n     * This method is used internally by `Typeson.parse()`.\n     * @param {object} obj - Object to revive. If it has `$types` member, the\n     *   properties that are listed there will be replaced with its true type\n     *   instead of just plain objects.\n     * @param {object} opts\n     * @throws TypeError If mismatch between sync/async type and result\n     * @returns {Promise|*} If async, returns a Promise that resolves to `*`\n     */\n\n  }, {\n    key: \"revive\",\n    value: function revive(obj, opts) {\n      var types = obj && obj.$types; // No type info added. Revival not needed.\n\n      if (!types) {\n        return obj;\n      } // Object happened to have own `$types` property but with\n      //   no actual types, so we unescape and return that object\n\n\n      if (types === true) {\n        return obj.$;\n      }\n\n      opts = _objectSpread({\n        sync: true\n      }, this.options, opts);\n      var _opts3 = opts,\n          sync = _opts3.sync;\n      var keyPathResolutions = [];\n      var stateObj = {};\n      var ignore$Types = true; // Special when root object is not a trivial Object, it will\n      //   be encapsulated in `$`. It will also be encapsulated in\n      //   `$` if it has its own `$` property to avoid ambiguity\n\n      if (types.$ && isPlainObject(types.$)) {\n        obj = obj.$;\n        types = types.$;\n        ignore$Types = false;\n      }\n\n      var that = this;\n\n      function revivePlainObjects() {\n        // const references = [];\n        // const reviveTypes = [];\n        var plainObjectTypes = [];\n        Object.entries(types).forEach(function (_ref2) {\n          var _ref3 = _slicedToArray(_ref2, 2),\n              keypath = _ref3[0],\n              type = _ref3[1];\n\n          if (type === '#') {\n            /*\n            references.push({\n                keypath,\n                reference: getByKeyPath(obj, keypath)\n            });\n            */\n            return;\n          }\n\n          [].concat(type).forEach(function (type) {\n            var _that$revivers$type = _slicedToArray(that.revivers[type], 2),\n                plain = _that$revivers$type[1].plain;\n\n            if (!plain) {\n              // reviveTypes.push({keypath, type});\n              return;\n            }\n\n            plainObjectTypes.push({\n              keypath: keypath,\n              type: type\n            });\n            delete types[keypath]; // Avoid repeating\n          });\n        });\n\n        if (!plainObjectTypes.length) {\n          return;\n        } // Handle plain object revivers first so reference\n        //   setting can use revived type (e.g., array instead\n        //   of object); assumes revived has same structure\n        //   or will otherwise break subsequent references\n\n\n        return plainObjectTypes.sort(nestedPathsFirst).reduce(function reducer(possibleTypesonPromise, _ref4) {\n          var keypath = _ref4.keypath,\n              type = _ref4.type;\n\n          if (hasConstructorOf(possibleTypesonPromise, TypesonPromise)) {\n            // TypesonPromise here too\n            return possibleTypesonPromise.then(function (v) {\n              return reducer(v, type);\n            });\n          }\n\n          var val = getByKeyPath(obj, keypath);\n\n          if (hasConstructorOf(val, TypesonPromise)) {\n            return val.then(function (v) {\n              // TypesonPromise here too\n              return reducer(v, type);\n            });\n          }\n\n          var _that$revivers$type2 = _slicedToArray(that.revivers[type], 1),\n              reviver = _that$revivers$type2[0];\n\n          if (!reviver) {\n            throw new Error('Unregistered type: ' + type);\n          }\n\n          val = reviver[sync && reviver.revive ? 'revive' : !sync && reviver.reviveAsync ? 'reviveAsync' : 'revive'](val, stateObj);\n\n          if (val === undefined) {\n            return undefined;\n          }\n\n          if (hasConstructorOf(val, Undefined)) {\n            val = undefined;\n          }\n\n          var newVal = setAtKeyPath(obj, keypath, val);\n\n          if (newVal === val) {\n            obj = val;\n          }\n\n          return undefined;\n        }, undefined // This argument must be explicit\n        ); // references.forEach(({keypath, reference}) => {});\n        // reviveTypes.sort(nestedPathsFirst).forEach(() => {});\n      }\n      /**\n       *\n       * @param {string} keypath\n       * @param {*} value\n       * @param {?(Array|object)} target\n       * @param {Array|object} [clone]\n       * @param {string} [key]\n       * @returns {*}\n       */\n\n\n      function _revive(keypath, value, target, clone, key) {\n        if (ignore$Types && keypath === '$types') {\n          return undefined;\n        }\n\n        var type = types[keypath];\n\n        if (isArray(value) || isPlainObject(value)) {\n          var _clone = isArray(value) ? new Array(value.length) : {}; // Iterate object or array\n\n\n          keys(value).forEach(function (k) {\n            var val = _revive(keypath + (keypath ? '.' : '') + escapeKeyPathComponent(k), value[k], target || _clone, _clone, k);\n\n            if (hasConstructorOf(val, Undefined)) {\n              _clone[k] = undefined;\n            } else if (val !== undefined) {\n              _clone[k] = val;\n            }\n          });\n          value = _clone; // Try to resolve cyclic reference as soon as available\n\n          while (keyPathResolutions.length) {\n            var _keyPathResolutions$ = _slicedToArray(keyPathResolutions[0], 4),\n                _target = _keyPathResolutions$[0],\n                keyPath = _keyPathResolutions$[1],\n                _clone2 = _keyPathResolutions$[2],\n                k = _keyPathResolutions$[3];\n\n            var val = getByKeyPath(_target, keyPath);\n\n            if (hasConstructorOf(val, Undefined)) {\n              _clone2[k] = undefined;\n            } else if (val !== undefined) {\n              _clone2[k] = val;\n            } else {\n              break;\n            }\n\n            keyPathResolutions.splice(0, 1);\n          }\n        }\n\n        if (!type) {\n          return value;\n        }\n\n        if (type === '#') {\n          var _ret = getByKeyPath(target, value.slice(1));\n\n          if (_ret === undefined) {\n            // Cyclic reference not yet available\n            keyPathResolutions.push([target, value.slice(1), clone, key]);\n          }\n\n          return _ret;\n        }\n\n        return [].concat(type).reduce(function reducer(val, type) {\n          if (hasConstructorOf(val, TypesonPromise)) {\n            return val.then(function (v) {\n              // TypesonPromise here too\n              return reducer(v, type);\n            });\n          }\n\n          var _that$revivers$type3 = _slicedToArray(that.revivers[type], 1),\n              reviver = _that$revivers$type3[0];\n\n          if (!reviver) {\n            throw new Error('Unregistered type: ' + type);\n          }\n\n          return reviver[sync && reviver.revive ? 'revive' : !sync && reviver.reviveAsync ? 'reviveAsync' : 'revive'](val, stateObj);\n        }, value);\n      }\n\n      function checkUndefined(retrn) {\n        return hasConstructorOf(retrn, Undefined) ? undefined : retrn;\n      }\n\n      var possibleTypesonPromise = revivePlainObjects();\n      var ret;\n\n      if (hasConstructorOf(possibleTypesonPromise, TypesonPromise)) {\n        ret = possibleTypesonPromise.then(function () {\n          return _revive('', obj, null);\n        });\n      } else {\n        ret = _revive('', obj, null);\n      }\n\n      return isThenable(ret) ? sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Sync method requested but async result obtained');\n      }() : hasConstructorOf(ret, TypesonPromise) ? ret.p.then(checkUndefined) : ret : !sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Async method requested but sync result obtained');\n      }() : sync ? checkUndefined(ret) : Promise.resolve(checkUndefined(ret));\n    }\n    /**\n     * Also sync but throws on non-sync result\n     * @param {*} obj\n     * @param {object} opts\n     * @returns {*}\n     */\n\n  }, {\n    key: \"reviveSync\",\n    value: function reviveSync(obj, opts) {\n      return this.revive(obj, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: true\n      }));\n    }\n    /**\n    * @param {*} obj\n    * @param {object} opts\n    * @returns {Promise} Resolves to `*`\n    */\n\n  }, {\n    key: \"reviveAsync\",\n    value: function reviveAsync(obj, opts) {\n      return this.revive(obj, _objectSpread({\n        throwOnBadSyncType: true\n      }, opts, {\n        sync: false\n      }));\n    }\n    /**\n     * Register types.\n     * For examples on how to use this method, see\n     *   {@link https://github.com/dfahlander/typeson-registry/tree/master/types}\n     * @param {Array.<Object.<string,Function[]>>} typeSpecSets - Types and\n     *   their functions [test, encapsulate, revive];\n     * @param {object} opts\n     * @returns {Typeson}\n     */\n\n  }, {\n    key: \"register\",\n    value: function register(typeSpecSets, opts) {\n      opts = opts || {};\n      [].concat(typeSpecSets).forEach(function R(typeSpec) {\n        // Allow arrays of arrays of arrays...\n        if (isArray(typeSpec)) {\n          return typeSpec.map(R, this);\n        }\n\n        typeSpec && keys(typeSpec).forEach(function (typeId) {\n          if (typeId === '#') {\n            throw new TypeError('# cannot be used as a type name as it is reserved ' + 'for cyclic objects');\n          } else if (Typeson.JSON_TYPES.includes(typeId)) {\n            throw new TypeError('Plain JSON object types are reserved as type names');\n          }\n\n          var spec = typeSpec[typeId];\n          var replacers = spec.testPlainObjects ? this.plainObjectReplacers : this.nonplainObjectReplacers;\n          var existingReplacer = replacers.filter(function (r) {\n            return r.type === typeId;\n          });\n\n          if (existingReplacer.length) {\n            // Remove existing spec and replace with this one.\n            replacers.splice(replacers.indexOf(existingReplacer[0]), 1);\n            delete this.revivers[typeId];\n            delete this.types[typeId];\n          }\n\n          if (!spec) {\n            return;\n          }\n\n          if (typeof spec === 'function') {\n            // Support registering just a class without replacer/reviver\n            var Class = spec;\n            spec = {\n              test: function test(x) {\n                return x && x.constructor === Class;\n              },\n              replace: function replace(x) {\n                return Object.assign({}, x);\n              },\n              revive: function revive(x) {\n                return Object.assign(Object.create(Class.prototype), x);\n              }\n            };\n          } else if (isArray(spec)) {\n            var _spec = spec,\n                _spec2 = _slicedToArray(_spec, 3),\n                test = _spec2[0],\n                replace = _spec2[1],\n                revive = _spec2[2];\n\n            spec = {\n              test: test,\n              replace: replace,\n              revive: revive\n            };\n          }\n\n          var replacerObj = {\n            type: typeId,\n            test: spec.test.bind(spec)\n          };\n\n          if (spec.replace) {\n            replacerObj.replace = spec.replace.bind(spec);\n          }\n\n          if (spec.replaceAsync) {\n            replacerObj.replaceAsync = spec.replaceAsync.bind(spec);\n          }\n\n          var start = typeof opts.fallback === 'number' ? opts.fallback : opts.fallback ? 0 : Infinity;\n\n          if (spec.testPlainObjects) {\n            this.plainObjectReplacers.splice(start, 0, replacerObj);\n          } else {\n            this.nonplainObjectReplacers.splice(start, 0, replacerObj);\n          } // Todo: We might consider a testAsync type\n\n\n          if (spec.revive || spec.reviveAsync) {\n            var reviverObj = {};\n\n            if (spec.revive) {\n              reviverObj.revive = spec.revive.bind(spec);\n            }\n\n            if (spec.reviveAsync) {\n              reviverObj.reviveAsync = spec.reviveAsync.bind(spec);\n            }\n\n            this.revivers[typeId] = [reviverObj, {\n              plain: spec.testPlainObjects\n            }];\n          } // Record to be retrieved via public types property.\n\n\n          this.types[typeId] = spec;\n        }, this);\n      }, this);\n      return this;\n    }\n  }]);\n\n  return Typeson;\n}();\n/**\n * We keep this function minimized so if using two instances of this\n * library, where one is minimized and one is not, it will still work\n * with `hasConstructorOf`.\n * @constructor\n */\n\n\nvar Undefined = function Undefined() {\n  _classCallCheck(this, Undefined);\n}; // eslint-disable-line space-before-blocks\n// The following provide classes meant to avoid clashes with other values\n// To insist `undefined` should be added\n\n\nTypeson.Undefined = Undefined; // To support async encapsulation/stringification\n\nTypeson.Promise = TypesonPromise; // Some fundamental type-checking utilities\n\nTypeson.isThenable = isThenable;\nTypeson.toStringTag = toStringTag;\nTypeson.hasConstructorOf = hasConstructorOf;\nTypeson.isObject = isObject;\nTypeson.isPlainObject = isPlainObject;\nTypeson.isUserObject = isUserObject;\nTypeson.escapeKeyPathComponent = escapeKeyPathComponent;\nTypeson.unescapeKeyPathComponent = unescapeKeyPathComponent;\nTypeson.getByKeyPath = getByKeyPath;\nTypeson.getJSONType = getJSONType;\nTypeson.JSON_TYPES = ['null', 'boolean', 'number', 'string', 'array', 'object'];\n\nexport default Typeson;\n","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2017 Brett Zamir, 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'; // Use a lookup table to find the index.\n\nvar lookup = new Uint8Array(256);\n\nfor (var i = 0; i < chars.length; i++) {\n  lookup[chars.charCodeAt(i)] = i;\n}\n\nvar encode = function encode(arraybuffer, byteOffset, length) {\n  if (length === null || length === undefined) {\n    length = arraybuffer.byteLength; // Needed for Safari\n  }\n\n  var bytes = new Uint8Array(arraybuffer, byteOffset || 0, // Default needed for Safari\n  length);\n  var len = bytes.length;\n  var base64 = '';\n\n  for (var _i = 0; _i < len; _i += 3) {\n    base64 += chars[bytes[_i] >> 2];\n    base64 += chars[(bytes[_i] & 3) << 4 | bytes[_i + 1] >> 4];\n    base64 += chars[(bytes[_i + 1] & 15) << 2 | bytes[_i + 2] >> 6];\n    base64 += chars[bytes[_i + 2] & 63];\n  }\n\n  if (len % 3 === 2) {\n    base64 = base64.substring(0, base64.length - 1) + '=';\n  } else if (len % 3 === 1) {\n    base64 = base64.substring(0, base64.length - 2) + '==';\n  }\n\n  return base64;\n};\nvar decode = function decode(base64) {\n  var len = base64.length;\n  var bufferLength = base64.length * 0.75;\n  var p = 0;\n  var encoded1, encoded2, encoded3, encoded4;\n\n  if (base64[base64.length - 1] === '=') {\n    bufferLength--;\n\n    if (base64[base64.length - 2] === '=') {\n      bufferLength--;\n    }\n  }\n\n  var arraybuffer = new ArrayBuffer(bufferLength),\n      bytes = new Uint8Array(arraybuffer);\n\n  for (var _i2 = 0; _i2 < len; _i2 += 4) {\n    encoded1 = lookup[base64.charCodeAt(_i2)];\n    encoded2 = lookup[base64.charCodeAt(_i2 + 1)];\n    encoded3 = lookup[base64.charCodeAt(_i2 + 2)];\n    encoded4 = lookup[base64.charCodeAt(_i2 + 3)];\n    bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n    bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n    bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n  }\n\n  return arraybuffer;\n};\n\nexport { decode, encode };\n","import Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nconst arraybuffer = {\n    arraybuffer: {\n        test (x) { return Typeson.toStringTag(x) === 'ArrayBuffer'; },\n        replace (b, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const index = stateObj.buffers.indexOf(b);\n            if (index > -1) {\n                return {index};\n            }\n            stateObj.buffers.push(b);\n            return encode(b);\n        },\n        revive (b64, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            if (typeof b64 === 'object') {\n                return stateObj.buffers[b64.index];\n            }\n            const buffer = decode(b64);\n            stateObj.buffers.push(buffer);\n            return buffer;\n        }\n    }\n};\n\nexport default arraybuffer;\n\n// See also typed-arrays!\n","/* globals BigInt */\nimport Typeson from 'typeson';\n\nconst bigintObject = {\n    bigintObject: {\n        test (x) {\n            return typeof x === 'object' && Typeson.hasConstructorOf(x, BigInt);\n        },\n        replace (n) { return String(n); },\n        revive (s) {\n            // Filed this to avoid error: https://github.com/eslint/eslint/issues/11810\n            // eslint-disable-next-line no-new-object\n            return new Object(BigInt(s));\n        }\n    }\n};\n\nexport default bigintObject;\n","/* globals BigInt */\n\nconst bigint = {\n    bigint: {\n        test (x) {\n            // eslint-disable-next-line valid-typeof\n            return typeof x === 'bigint';\n        },\n        replace (n) { return String(n); },\n        revive (s) { return BigInt(s); }\n    }\n};\n\nexport default bigint;\n","/**\n *\n * @param {ArrayBuffer} buf\n * @returns {Uint8Array}\n */\nfunction arraybuffer2string (buf) {\n    return new Uint8Array(buf).reduce(\n        (s, byte) => s + String.fromCharCode(byte), ''\n    );\n}\n\n/**\n *\n * @param {string} str\n * @returns {ArrayBuffer}\n */\nfunction string2arraybuffer (str) {\n    /*\n    // UTF-8 approaches\n    const utf8 = unescape(encodeURIComponent(str));\n    const arr = new Uint8Array(utf8.length);\n    for (let i = 0; i < utf8.length; i++) {\n        arr[i] = utf8.charCodeAt(i);\n    }\n    return arr.buffer;\n\n    const utf8 = [];\n    for (let i = 0; i < str.length; i++) {\n        let charcode = str.charCodeAt(i);\n        if (charcode < 0x80) utf8.push(charcode);\n        else if (charcode < 0x800) {\n            utf8.push(0xc0 | (charcode >> 6),\n                0x80 | (charcode & 0x3f));\n        } else if (charcode < 0xd800 || charcode >= 0xe000) {\n            utf8.push(0xe0 | (charcode >> 12),\n                0x80 | ((charcode >> 6) & 0x3f),\n                0x80 | (charcode & 0x3f));\n        // surrogate pair\n        } else {\n            i++;\n            // UTF-16 encodes 0x10000-0x10FFFF by\n            // subtracting 0x10000 and splitting the\n            // 20 bits of 0x0-0xFFFFF into two halves\n            charcode = 0x10000 + (((charcode & 0x3ff) << 10) |\n                (str.charCodeAt(i) & 0x3ff));\n            utf8.push(0xf0 | (charcode >> 18),\n                0x80 | ((charcode >> 12) & 0x3f),\n                0x80 | ((charcode >> 6) & 0x3f),\n                0x80 | (charcode & 0x3f));\n        }\n    }\n    return utf8;\n    */\n    /*\n    // Working UTF-16 options (equivalents)\n    const buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char\n    const bufView = new Uint16Array(buf);\n    for (let i = 0, strLen = str.length; i < strLen; i++) {\n        bufView[i] = str.charCodeAt(i);\n    }\n    return buf;\n    */\n\n    const array = new Uint8Array(str.length);\n    for (let i = 0; i < str.length; i++) {\n        array[i] = str.charCodeAt(i); // & 0xff;\n    }\n    return array.buffer;\n}\nexport {arraybuffer2string, string2arraybuffer};\n","/* globals XMLHttpRequest, Blob, FileReader */\nimport Typeson from 'typeson';\nimport {string2arraybuffer} from '../utils/stringArrayBuffer.js';\n\nconst blob = {\n    blob: {\n        test (x) { return Typeson.toStringTag(x) === 'Blob'; },\n        replace (b) { // Sync\n            const req = new XMLHttpRequest();\n            req.overrideMimeType('text/plain; charset=x-user-defined');\n            // eslint-disable-next-line max-len\n            // eslint-disable-next-line node/no-unsupported-features/node-builtins\n            req.open('GET', URL.createObjectURL(b), false); // Sync\n            if (req.status !== 200 && req.status !== 0) {\n                throw new Error('Bad Blob access: ' + req.status);\n            }\n            req.send();\n            return {\n                type: b.type,\n                stringContents: req.responseText\n            };\n        },\n        revive ({type, stringContents}) {\n            return new Blob([string2arraybuffer(stringContents)], {type});\n        },\n        replaceAsync (b) {\n            return new Typeson.Promise((resolve, reject) => {\n                if (b.isClosed) { // On MDN, but not in https://w3c.github.io/FileAPI/#dfn-Blob\n                    reject(new Error('The Blob is closed'));\n                    return;\n                }\n                const reader = new FileReader();\n                reader.addEventListener('load', () => {\n                    resolve({\n                        type: b.type,\n                        stringContents: reader.result\n                    });\n                });\n                reader.addEventListener('error', () => {\n                    reject(reader.error);\n                });\n                reader.readAsBinaryString(b);\n            });\n        }\n    }\n};\n\nexport default blob;\n","/* globals performance */\n\n// The `performance` global is optional\n\n/**\n * @todo We could use `import generateUUID from 'uuid/v4';` (but it needs\n *   crypto library, etc.; `rollup-plugin-node-builtins` doesn't recommend\n *   using its own version and though there is <https://www.npmjs.com/package/crypto-browserify>,\n *   it may be troublesome to bundle and not strongly needed)\n * @returns {string}\n */\nexport default function generateUUID () { //  Adapted from original: public domain/MIT: http://stackoverflow.com/a/8809472/271577\n    let d = new Date().getTime();\n    if (typeof performance !== 'undefined' &&\n        typeof performance.now === 'function'\n    ) {\n        d += performance.now(); // use high-precision timer if available\n    }\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/gu, function (c) {\n        /* eslint-disable no-bitwise */\n        const r = (d + Math.random() * 16) % 16 | 0;\n        d = Math.floor(d / 16);\n        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\n        /* eslint-enable no-bitwise */\n    });\n}\n","import generateUUID from '../utils/generateUUID.js';\n\nconst cloneableObjectsByUUID = {};\n\nconst cloneable = {\n    cloneable: {\n        test (x) {\n            return x && typeof x === 'object' &&\n                typeof x[Symbol.for('cloneEncapsulate')] === 'function';\n        },\n        replace (clonable) {\n            const encapsulated = clonable[Symbol.for('cloneEncapsulate')]();\n            const uuid = generateUUID();\n            cloneableObjectsByUUID[uuid] = clonable;\n            return {uuid, encapsulated};\n        },\n        revive ({uuid, encapsulated}) {\n            return cloneableObjectsByUUID[uuid][Symbol.for('cloneRevive')](\n                encapsulated\n            );\n        }\n    }\n};\n\nexport default cloneable;\n","import Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nconst dataview = {\n    dataview: {\n        test (x) { return Typeson.toStringTag(x) === 'DataView'; },\n        replace ({buffer, byteOffset, byteLength}, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const index = stateObj.buffers.indexOf(buffer);\n            if (index > -1) {\n                return {index, byteOffset, byteLength};\n            }\n            stateObj.buffers.push(buffer);\n            return {\n                encoded: encode(buffer),\n                byteOffset,\n                byteLength\n            };\n        },\n        revive (b64Obj, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const {byteOffset, byteLength, encoded, index} = b64Obj;\n            let buffer;\n            if ('index' in b64Obj) {\n                buffer = stateObj.buffers[index];\n            } else {\n                buffer = decode(encoded);\n                stateObj.buffers.push(buffer);\n            }\n            return new DataView(buffer, byteOffset, byteLength);\n        }\n    }\n};\n\nexport default dataview;\n","import Typeson from 'typeson';\n\nconst date = {\n    date: {\n        test (x) { return Typeson.toStringTag(x) === 'Date'; },\n        replace (dt) {\n            const time = dt.getTime();\n            if (isNaN(time)) {\n                return 'NaN';\n            }\n            return time;\n        },\n        revive (time) {\n            if (time === 'NaN') {\n                return new Date(NaN);\n            }\n            return new Date(time);\n        }\n    }\n};\n\nexport default date;\n","import Typeson from 'typeson';\n\nconst error = {\n    error: {\n        test (x) { return Typeson.toStringTag(x) === 'Error'; },\n        replace ({name, message}) {\n            return {name, message};\n        },\n        revive ({name, message}) {\n            const e = new Error(message);\n            e.name = name;\n            return e;\n        }\n    }\n};\n// See also errors.js that may be registered after having registered this type.\n\nexport default error;\n","/* eslint-env browser, node */\nimport Typeson from 'typeson';\n\nconst _global = typeof self === 'undefined' ? global : self;\n\nconst errors = {};\n// Comprises all built-in errors.\n[\n    'TypeError',\n    'RangeError',\n    'SyntaxError',\n    'ReferenceError',\n    'EvalError',\n    'URIError',\n    'InternalError' // non-standard\n].forEach((errName) => {\n    const Cnstrctr = _global[errName];\n    if (Cnstrctr) {\n        errors[errName.toLowerCase()] = {\n            test (x) { return Typeson.hasConstructorOf(x, Cnstrctr); },\n            replace (e) { return e.message; },\n            revive (message) { return new Cnstrctr(message); }\n        };\n    }\n});\n\nexport default errors;\n","/* globals XMLHttpRequest, File, FileReader */\nimport Typeson from 'typeson';\nimport {string2arraybuffer} from '../utils/stringArrayBuffer.js';\n\nconst file = {\n    file: {\n        test (x) { return Typeson.toStringTag(x) === 'File'; },\n        replace (f) { // Sync\n            const req = new XMLHttpRequest();\n            req.overrideMimeType('text/plain; charset=x-user-defined');\n            // eslint-disable-next-line max-len\n            // eslint-disable-next-line node/no-unsupported-features/node-builtins\n            req.open('GET', URL.createObjectURL(f), false); // Sync\n            if (req.status !== 200 && req.status !== 0) {\n                throw new Error('Bad Blob access: ' + req.status);\n            }\n            req.send();\n            return {\n                type: f.type,\n                stringContents: req.responseText,\n                name: f.name,\n                lastModified: f.lastModified\n            };\n        },\n        revive ({name, type, stringContents, lastModified}) {\n            return new File([string2arraybuffer(stringContents)], name, {\n                type,\n                lastModified\n            });\n        },\n        replaceAsync (f) {\n            return new Typeson.Promise(function (resolve, reject) {\n                if (f.isClosed) { // On MDN, but not in https://w3c.github.io/FileAPI/#dfn-Blob\n                    reject(new Error('The File is closed'));\n                    return;\n                }\n                const reader = new FileReader();\n                reader.addEventListener('load', function () {\n                    resolve({\n                        type: f.type,\n                        stringContents: reader.result,\n                        name: f.name,\n                        lastModified: f.lastModified\n                    });\n                });\n                reader.addEventListener('error', function () {\n                    reject(reader.error);\n                });\n                reader.readAsBinaryString(f);\n            });\n        }\n    }\n};\n\nexport default file;\n","import Typeson from 'typeson';\nimport file from './file.js';\n\nconst filelist = {\n    file: file.file,\n    filelist: {\n        test (x) { return Typeson.toStringTag(x) === 'FileList'; },\n        replace (fl) {\n            const arr = [];\n            for (let i = 0; i < fl.length; i++) {\n                arr[i] = fl.item(i);\n            }\n            return arr;\n        },\n        revive (o) {\n            class FileList {\n                constructor () {\n                    // eslint-disable-next-line prefer-rest-params\n                    this._files = arguments[0];\n                    this.length = this._files.length;\n                }\n                item (index) {\n                    return this._files[index];\n                }\n                // eslint-disable-next-line class-methods-use-this\n                get [Symbol.toStringTag] () {\n                    return 'FileList';\n                }\n            }\n            return new FileList(o);\n        }\n    }\n};\n\nexport default filelist;\n","/* globals createImageBitmap */\n// `ImageBitmap` is browser / DOM specific. It also can only work\n//  same-domain (or CORS)\n\nimport Typeson from 'typeson';\n\nconst imagebitmap = {\n    imagebitmap: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'ImageBitmap' ||\n                // In Node, our polyfill sets the dataset on a canvas\n                //  element as JSDom no longer allows overriding toStringTag\n                (x && x.dataset && x.dataset.toStringTag === 'ImageBitmap');\n        },\n        replace (bm) {\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            ctx.drawImage(bm, 0, 0);\n            // Although `width` and `height` are part of `ImageBitMap`,\n            //   these will be auto-created for us when reviving with the\n            //   data URL (and they are not settable even if they weren't)\n            // return {\n            //   width: bm.width, height: bm.height, dataURL: canvas.toDataURL()\n            // };\n            return canvas.toDataURL();\n        },\n        revive (o) {\n            /*\n            var req = new XMLHttpRequest();\n            req.open('GET', o, false); // Sync\n            if (req.status !== 200 && req.status !== 0) {\n              throw new Error('Bad ImageBitmap access: ' + req.status);\n            }\n            req.send();\n            return req.responseText;\n            */\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            const img = document.createElement('img');\n            // The onload is needed by some browsers per http://stackoverflow.com/a/4776378/271577\n            img.addEventListener('load', function () {\n                ctx.drawImage(img, 0, 0);\n            });\n            img.src = o;\n            // Works in contexts allowing an `ImageBitmap` (We might use\n            //   `OffscreenCanvas.transferToBitmap` when supported)\n            return canvas;\n        },\n        reviveAsync (o) {\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            const img = document.createElement('img');\n            // The onload is needed by some browsers per http://stackoverflow.com/a/4776378/271577\n            img.addEventListener('load', function () {\n                ctx.drawImage(img, 0, 0);\n            });\n            img.src = o; // o.dataURL;\n            return createImageBitmap(canvas); // Returns a promise\n        }\n    }\n};\n\nexport default imagebitmap;\n","/* globals ImageData */\n// `ImageData` is browser / DOM specific (though `node-canvas` has it\n//   available on `Canvas`).\n\nimport Typeson from 'typeson';\n\nconst imagedata = {\n    imagedata: {\n        test (x) { return Typeson.toStringTag(x) === 'ImageData'; },\n        replace (d) {\n            return {\n                // Ensure `length` gets preserved for revival\n                array: [...d.data],\n                width: d.width,\n                height: d.height\n            };\n        },\n        revive (o) {\n            return new ImageData(\n                new Uint8ClampedArray(o.array), o.width, o.height\n            );\n        }\n    }\n};\n\nexport default imagedata;\n","const infinity = {\n    infinity: {\n        test (x) { return x === Infinity; },\n        replace (n) { return 'Infinity'; },\n        revive (s) { return Infinity; }\n    }\n};\n\nexport default infinity;\n","import Typeson from 'typeson';\n\nconst IntlCollator = {\n    test (x) { return Typeson.hasConstructorOf(x, Intl.Collator); },\n    replace (c) { return c.resolvedOptions(); },\n    revive (options) { return new Intl.Collator(options.locale, options); }\n};\n\nconst IntlDateTimeFormat = {\n    test (x) { return Typeson.hasConstructorOf(x, Intl.DateTimeFormat); },\n    replace (dtf) { return dtf.resolvedOptions(); },\n    revive (options) {\n        return new Intl.DateTimeFormat(options.locale, options);\n    }\n};\n\nconst IntlNumberFormat = {\n    test (x) { return Typeson.hasConstructorOf(x, Intl.NumberFormat); },\n    replace (nf) { return nf.resolvedOptions(); },\n    revive (options) { return new Intl.NumberFormat(options.locale, options); }\n};\n\nconst intlTypes = {\n    IntlCollator,\n    IntlDateTimeFormat,\n    IntlNumberFormat\n};\n\nexport default intlTypes;\n","import Typeson from 'typeson';\n\nconst map = {\n    map: {\n        test (x) { return Typeson.toStringTag(x) === 'Map'; },\n        replace (mp) { return [...mp.entries()]; },\n        revive (entries) { return new Map(entries); }\n    }\n};\n\nexport default map;\n","const nan = {\n    nan: {\n        test (x) { return typeof x === 'number' && isNaN(x); },\n        replace (n) { return 'NaN'; },\n        revive (s) { return NaN; }\n    }\n};\n\nexport default nan;\n","const negativeInfinity = {\n    negativeInfinity: {\n        test (x) { return x === -Infinity; },\n        replace (n) { return '-Infinity'; },\n        revive (s) { return -Infinity; }\n    }\n};\n\nexport default negativeInfinity;\n","import Typeson from 'typeson';\n\nconst nonbuiltinIgnore = {\n    nonbuiltinIgnore: {\n        test (x) {\n            return x && typeof x === 'object' && !Array.isArray(x) && ![\n                'Object',\n                // `Proxy` and `Reflect`, two other built-in objects, will also\n                //   have a `toStringTag` of `Object`; we don't want built-in\n                //   function objects, however\n                'Boolean', 'Number', 'String',\n                'Error', 'RegExp', 'Math', 'Date',\n                'Map', 'Set',\n                'JSON',\n                'ArrayBuffer', 'SharedArrayBuffer', 'DataView',\n                'Int8Array', 'Uint8Array', 'Uint8ClampedArray', 'Int16Array',\n                'Uint16Array', 'Int32Array', 'Uint32Array',\n                'Float32Array', 'Float64Array',\n                'Promise',\n                'String Iterator', 'Array Iterator',\n                'Map Iterator', 'Set Iterator',\n                'WeakMap', 'WeakSet',\n                'Atomics', 'Module'\n            ].includes(Typeson.toStringTag(x));\n        },\n        replace (rexp) {\n            // Not in use\n        }\n    }\n};\n\nexport default nonbuiltinIgnore;\n","// This module is for objectified primitives (such as `new Number(3)` or\n//      `new String(\"foo\")`)\n/* eslint-disable no-new-wrappers, unicorn/new-for-builtins */\nimport Typeson from 'typeson';\n\nconst primitiveObjects = {\n    // String Object (not primitive string which need no type spec)\n    StringObject: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'String' && typeof x === 'object';\n        },\n        replace (s) { return String(s); }, // convert to primitive string\n        revive (s) { return new String(s); } // Revive to an objectified string\n    },\n    // Boolean Object (not primitive boolean which need no type spec)\n    BooleanObject: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'Boolean' &&\n                typeof x === 'object';\n        },\n        replace (b) { return Boolean(b); }, // convert to primitive boolean\n        revive (b) {\n            // Revive to an objectified Boolean\n            return new Boolean(b);\n        }\n    },\n    // Number Object (not primitive number which need no type spec)\n    NumberObject: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'Number' && typeof x === 'object';\n        },\n        replace (n) { return Number(n); }, // convert to primitive number\n        revive (n) { return new Number(n); } // Revive to an objectified number\n    }\n};\n/* eslint-enable no-new-wrappers, unicorn/new-for-builtins */\n\nexport default primitiveObjects;\n","import Typeson from 'typeson';\n\nconst regexp = {\n    regexp: {\n        test (x) { return Typeson.toStringTag(x) === 'RegExp'; },\n        replace (rexp) {\n            return {\n                source: rexp.source,\n                flags: (rexp.global ? 'g' : '') +\n                    (rexp.ignoreCase ? 'i' : '') +\n                    (rexp.multiline ? 'm' : '') +\n                    (rexp.sticky ? 'y' : '') +\n                    (rexp.unicode ? 'u' : '')\n            };\n        },\n        revive ({source, flags}) { return new RegExp(source, flags); }\n    }\n};\n\nexport default regexp;\n","// Here we allow the exact same non-plain object, function, and symbol\n//  instances to be resurrected (assuming the same session/environment);\n//  plain objects are ignored by Typeson so not presently available and\n//  we consciously exclude arrays\n\nimport generateUUID from '../utils/generateUUID.js';\n\nconst resurrectableObjectsByUUID = {};\n\nconst resurrectable = {\n    resurrectable: {\n        test (x) {\n            return x &&\n                !Array.isArray(x) &&\n                ['object', 'function', 'symbol'].includes(typeof x);\n        },\n        replace (rsrrctble) {\n            const uuid = generateUUID();\n            resurrectableObjectsByUUID[uuid] = rsrrctble;\n            return uuid;\n        },\n        revive (serializedResurrectable) {\n            return resurrectableObjectsByUUID[serializedResurrectable];\n        }\n    }\n};\n\nexport default resurrectable;\n","import Typeson from 'typeson';\n\nconst set = {\n    set: {\n        test (x) { return Typeson.toStringTag(x) === 'Set'; },\n        replace (st) {\n            return [...st.values()];\n        },\n        revive (values) { return new Set(values); }\n    }\n};\n\nexport default set;\n","/* eslint-env browser, node */\nimport Typeson from 'typeson';\n\nconst _global = typeof self === 'undefined' ? global : self;\n\n// Support all kinds of typed arrays (views of ArrayBuffers)\nconst typedArraysSocketIO = {};\n[\n    'Int8Array',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Int16Array',\n    'Uint16Array',\n    'Int32Array',\n    'Uint32Array',\n    'Float32Array',\n    'Float64Array'\n].forEach(function (typeName) {\n    const arrType = typeName;\n    const TypedArray = _global[typeName];\n    if (TypedArray) {\n        typedArraysSocketIO[typeName.toLowerCase()] = {\n            test (x) { return Typeson.toStringTag(x) === arrType; },\n            replace (a) {\n                return (a.byteOffset === 0 &&\n                    a.byteLength === a.buffer.byteLength\n                    ? a\n                    // socket.io supports streaming ArrayBuffers.\n                    //   If we have a typed array\n                    // representing a portion of the buffer, we need to clone\n                    //   the buffer before leaving it to socket.io.\n                    : a.slice(0)).buffer;\n            },\n            revive (buf) {\n                // One may configure socket.io to revive binary data as\n                //    Buffer or Blob.\n                // We should therefore not rely on that the instance we\n                //   get here is an ArrayBuffer\n                // If not, let's assume user wants to receive it as\n                //   configured with socket.io.\n                return Typeson.toStringTag(buf) === 'ArrayBuffer'\n                    ? new TypedArray(buf)\n                    : buf;\n            }\n        };\n    }\n});\n\nexport default typedArraysSocketIO;\n","/* eslint-env browser, node */\nimport Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nconst _global = typeof self === 'undefined' ? global : self;\n\nconst typedArrays = {};\n[\n    'Int8Array',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Int16Array',\n    'Uint16Array',\n    'Int32Array',\n    'Uint32Array',\n    'Float32Array',\n    'Float64Array'\n].forEach(function (typeName) {\n    const arrType = typeName;\n    const TypedArray = _global[arrType];\n    if (TypedArray) {\n        typedArrays[typeName.toLowerCase()] = {\n            test (x) { return Typeson.toStringTag(x) === arrType; },\n            replace ({buffer, byteOffset, length: l}, stateObj) {\n                if (!stateObj.buffers) {\n                    stateObj.buffers = [];\n                }\n                const index = stateObj.buffers.indexOf(buffer);\n                if (index > -1) {\n                    return {index, byteOffset, length: l};\n                }\n                stateObj.buffers.push(buffer);\n                return {\n                    encoded: encode(buffer),\n                    byteOffset,\n                    length: l\n                };\n            },\n            revive (b64Obj, stateObj) {\n                if (!stateObj.buffers) {\n                    stateObj.buffers = [];\n                }\n                const {byteOffset, length: len, encoded, index} = b64Obj;\n                let buffer;\n                if ('index' in b64Obj) {\n                    buffer = stateObj.buffers[index];\n                } else {\n                    buffer = decode(encoded);\n                    stateObj.buffers.push(buffer);\n                }\n                return new TypedArray(buffer, byteOffset, len);\n            }\n        };\n    }\n});\n\nexport default typedArrays;\n","// This does not preserve `undefined` in sparse arrays; see the `undefined`\n//  or `sparse-undefined` preset\nimport Typeson from 'typeson';\n\nconst undef = {\n    undef: {\n        test (x, stateObj) {\n            return typeof x === 'undefined' &&\n                (stateObj.ownKeys || !('ownKeys' in stateObj));\n        },\n        replace (n) { return 0; },\n        revive (s) {\n            // Will add `undefined` (returning `undefined` would instead\n            //   avoid explicitly setting)\n            return new Typeson.Undefined();\n        }\n    }\n};\n\nexport default undef;\n","import Typeson from 'typeson';\n\nconst userObject = {\n    userObject: {\n        test (x, stateObj) { return Typeson.isUserObject(x); },\n        replace (n) { return {...n}; },\n        revive (s) { return s; }\n    }\n};\n\nexport default userObject;\n","const arrayNonindexKeys = [\n    {\n        arrayNonindexKeys: {\n            testPlainObjects: true,\n            test (x, stateObj) {\n                if (Array.isArray(x)) {\n                    if (\n                        // By avoiding serializing arrays into objects which\n                        //  have only positive-integer keys, we reduce\n                        //  size and improve revival performance; arrays with\n                        //  non-index keys will be larger however\n                        Object.keys(x).some((k) => {\n                            //  No need to check for `isNaN` or\n                            //   `isNaN(parseInt())` as `NaN` will be treated\n                            //   as a string.\n                            //  No need to do check as `parseInt(Number())`\n                            //   since scientific notation will be\n                            //   pre-resolved if a number was given, and it\n                            //   will otherwise be a string\n                            return String(parseInt(k)) !== k;\n                        })\n                    ) {\n                        stateObj.iterateIn = 'object';\n                        stateObj.addLength = true;\n                    }\n                    return true;\n                }\n                return false;\n            },\n            replace (a, stateObj) {\n                if (Array.isArray(a)) {\n                    // Catch sparse undefined\n                    stateObj.iterateUnsetNumeric = true;\n                }\n                return a;\n            },\n            revive (o) {\n                if (Array.isArray(o)) {\n                    return o;\n                }\n                const arr = [];\n                // No map here as may be a sparse array (including\n                //   with `length` set)\n                // Todo: Reenable when Node `engines` >= 7\n                // Object.entries(o).forEach(([key, val]) => {\n                Object.keys(o).forEach((key) => {\n                    const val = o[key];\n                    arr[key] = val;\n                });\n                return arr;\n            }\n        }\n    },\n    {\n        sparseUndefined: {\n            test (x, stateObj) {\n                return typeof x === 'undefined' && stateObj.ownKeys === false;\n            },\n            replace (n) { return 0; },\n            revive (s) { return undefined; } // Will avoid adding anything\n        }\n    }\n];\n\nexport default arrayNonindexKeys;\n","import nan from '../types/nan.js';\nimport infinity from '../types/infinity.js';\nimport NegativeInfinity from '../types/negative-infinity.js';\n\nconst specialNumbers = [\n    nan,\n    infinity,\n    NegativeInfinity\n];\n\nexport default specialNumbers;\n","/* This preset includes types that are built-in into the JavaScript\n    language itself, this should work universally.\n\n  Types that were added in ES6 or beyond will be checked before inclusion\n   so that this module can be consumed by both ES5 and ES6 environments.\n\n  Some types cannot be encapsulated because their inner state is private:\n    `WeakMap`, `WeakSet`.\n\n  The Function type is not included because their closures would not be\n    serialized, so a revived Function that uses closures would not behave\n    as expected.\n\n  Symbols are similarly not included.\n*/\n\nimport arrayNonindexKeys from './array-nonindex-keys.js';\nimport undef from '../types/undef.js';\nimport primitiveObjects from '../types/primitive-objects.js';\nimport specialNumbers from './special-numbers.js';\nimport date from '../types/date.js';\nimport error from '../types/error.js';\nimport errors from '../types/errors.js';\nimport regexp from '../types/regexp.js';\nimport map from '../types/map.js';\nimport set from '../types/set.js';\nimport arraybuffer from '../types/arraybuffer.js';\nimport typedArrays from '../types/typed-arrays.js';\nimport dataview from '../types/dataview.js';\nimport intlTypes from '../types/intl-types.js';\nimport bigint from '../types/bigint.js';\nimport bigintObject from '../types/bigint-object.js';\n\nconst expObj = [\n    undef,\n    // ES5\n    arrayNonindexKeys, primitiveObjects, specialNumbers,\n    date, error, errors, regexp\n].concat(\n    // ES2015 (ES6)\n    typeof Map === 'function' ? map : [],\n    typeof Set === 'function' ? set : [],\n    typeof ArrayBuffer === 'function' ? arraybuffer : [],\n    typeof Uint8Array === 'function' ? typedArrays : [],\n    typeof DataView === 'function' ? dataview : [],\n    typeof Intl !== 'undefined' ? intlTypes : [],\n\n    typeof BigInt !== 'undefined' ? [bigint, bigintObject] : []\n);\nexport default expObj;\n","/*\nWhen communicating via `postMessage()` (`Worker.postMessage()` or\n`window.postMessage()`), the browser will use a similar algorithm as Typeson\ndoes to encapsulate and revive all items in the structure (aka the structured\nclone algorithm). This algorithm supports all built-in types as well as many\nDOM types. Therefore, only types that are not included in the structured clone\nalgorithm need to be registered, which is:\n\n* Error\n* Specific Errors like SyntaxError, TypeError, etc.\n* Any custom type you want to send across window- or worker boundraries\n\nThis preset will only include the Error types and you can register your\ncustom types after having registered these.\n*/\n\nimport error from '../types/error.js';\nimport errors from '../types/errors.js';\n\nconst postmessage = [\n    error,\n    errors\n];\n\nexport default postmessage;\n","import builtin from './builtin.js';\nimport typedArraysSocketIO from '../types/typed-arrays-socketio.js';\n\nconst socketio = [\n    builtin,\n    // Leave ArrayBuffer as is, and let socket.io stream it instead.\n    {ArrayBuffer: null},\n    // Encapsulate TypedArrays in ArrayBuffers instead of base64 strings.\n    typedArraysSocketIO\n];\n\nexport default socketio;\n","const sparseUndefined = [\n    {\n        sparseArrays: {\n            testPlainObjects: true,\n            test (x) { return Array.isArray(x); },\n            replace (a, stateObj) {\n                stateObj.iterateUnsetNumeric = true;\n                return a;\n            }\n        }\n    },\n    {\n        sparseUndefined: {\n            test (x, stateObj) {\n                return typeof x === 'undefined' && stateObj.ownKeys === false;\n            },\n            replace (n) { return 0; },\n            revive (s) { return undefined; } // Will avoid adding anything\n        }\n    }\n];\n\nexport default sparseUndefined;\n","/* This preset includes types for the Structured Cloning Algorithm. */\n\nimport userObject from '../types/user-object.js';\nimport arrayNonindexKeys from './array-nonindex-keys.js';\nimport undef from '../types/undef.js';\nimport primitiveObjects from '../types/primitive-objects.js';\nimport specialNumbers from './special-numbers.js';\nimport date from '../types/date.js';\nimport regexp from '../types/regexp.js';\nimport map from '../types/map.js';\nimport set from '../types/set.js';\nimport arraybuffer from '../types/arraybuffer.js';\nimport typedArrays from '../types/typed-arrays.js';\nimport dataview from '../types/dataview.js';\nimport intlTypes from '../types/intl-types.js';\n\nimport imagedata from '../types/imagedata.js';\nimport imagebitmap from '../types/imagebitmap.js'; // Async return\nimport file from '../types/file.js';\nimport filelist from '../types/filelist.js';\nimport blob from '../types/blob.js';\nimport bigint from '../types/bigint.js';\nimport bigintObject from '../types/bigint-object.js';\n\nconst expObj = [\n    // Todo: Might also register synchronous `ImageBitmap` and\n    //    `Blob`/`File`/`FileList`?\n    // ES5\n    userObject, // Processed last (non-builtin)\n\n    undef,\n    arrayNonindexKeys, primitiveObjects, specialNumbers,\n    date, regexp,\n\n    // Non-built-ins\n    imagedata,\n    imagebitmap, // Async return\n    file,\n    filelist,\n    blob\n].concat(\n    // ES2015 (ES6)\n    typeof Map === 'function' ? map : [],\n    typeof Set === 'function' ? set : [],\n    typeof ArrayBuffer === 'function' ? arraybuffer : [],\n    typeof Uint8Array === 'function' ? typedArrays : [],\n    typeof DataView === 'function' ? dataview : [],\n    typeof Intl !== 'undefined' ? intlTypes : [],\n\n    typeof BigInt !== 'undefined' ? [bigint, bigintObject] : []\n);\nexport default expObj;\n","/* globals DOMException */\nimport structuredCloning from './structured-cloning.js';\n\nexport default structuredCloning.concat({\n    checkDataCloneException: [function (val) {\n        // Should also throw with:\n        // 1. `IsDetachedBuffer` (a process not called within the\n        //      ECMAScript spec)\n        // 2. `IsCallable` (covered by `typeof === 'function'` or a\n        //       function's `toStringTag`)\n        // 3. internal slots besides [[Prototype]] or [[Extensible]] (e.g.,\n        //        [[PromiseState]] or [[WeakMapData]])\n        // 4. exotic object (e.g., `Proxy`) (which does not have default\n        //      behavior for one or more of the essential internal methods\n        //      that are limited to the following for non-function objects\n        //      (we auto-exclude functions):\n        //      [[GetPrototypeOf]],[[SetPrototypeOf]],[[IsExtensible]],\n        //      [[PreventExtensions]],[[GetOwnProperty]],\n        //      [[DefineOwnProperty]],[[HasProperty]],\n        //      [[Get]],[[Set]],[[Delete]],[[OwnPropertyKeys]]);\n        //      except for the standard, built-in exotic objects, we'd need\n        //      to know whether these methods had distinct behaviors\n        // Note: There is no apparent way for us to detect a `Proxy` and\n        //      reject (Chrome at least is not rejecting anyways)\n        const stringTag = ({}.toString.call(val).slice(8, -1));\n        if (\n            [\n                // Symbol's `toStringTag` is only \"Symbol\" for its initial\n                //   value, so we check `typeof`\n                'symbol',\n                // All functions including bound function exotic objects\n                'function'\n            ].includes(typeof val) ||\n            [\n                // A non-array exotic object\n                'Arguments',\n                // A non-array exotic object\n                'Module',\n                // `Error` and other errors have the [[ErrorData]] internal\n                //    slot and give \"Error\"\n                'Error',\n                // Promise instances have an extra slot ([[PromiseState]])\n                //    but not throwing in Chrome `postMessage`\n                'Promise',\n                // WeakMap instances have an extra slot ([[WeakMapData]])\n                //    but not throwing in Chrome `postMessage`\n                'WeakMap',\n                // WeakSet instances have an extra slot ([[WeakSetData]])\n                //    but not throwing in Chrome `postMessage`\n                'WeakSet',\n\n                // HTML-SPECIFIC\n                'Event',\n                // Also in Node `worker_threads` (currently experimental)\n                'MessageChannel'\n            ].includes(stringTag) ||\n            // A non-array exotic object but not throwing in\n            //   Chrome `postMessage`\n            val === Object.prototype ||\n            ((stringTag === 'Blob' || stringTag === 'File') && val.isClosed) ||\n            (val && typeof val === 'object' &&\n                // Duck-type DOM node objects (non-array exotic? objects which\n                //    cannot be cloned by the SCA)\n                typeof val.nodeType === 'number' &&\n                typeof val.insertBefore === 'function')\n        ) {\n            throw new DOMException(\n                'The object cannot be cloned.', 'DataCloneError'\n            );\n        }\n        return false;\n    }]\n});\n","import sparseUndefined from './sparse-undefined.js';\nimport undf from '../types/undef.js';\n\nconst undef = [\n    sparseUndefined,\n    undf\n];\n\nexport default undef;\n","import builtin from './builtin.js';\n\nconst universal = [\n    builtin\n    // TODO: Add types that are de-facto universal even though not\n    //   built-in into ecmasript standard.\n];\n\nexport default universal;\n","// This file is auto-generated from `build.js`\nimport Typeson from 'typeson';\n\n// TYPES\nimport arraybuffer from './types/arraybuffer.js';\nimport bigintObject from './types/bigint-object.js';\nimport bigint from './types/bigint.js';\nimport blob from './types/blob.js';\nimport cloneable from './types/cloneable.js';\nimport dataview from './types/dataview.js';\nimport date from './types/date.js';\nimport error from './types/error.js';\nimport errors from './types/errors.js';\nimport file from './types/file.js';\nimport filelist from './types/filelist.js';\nimport imagebitmap from './types/imagebitmap.js';\nimport imagedata from './types/imagedata.js';\nimport infinity from './types/infinity.js';\nimport intlTypes from './types/intl-types.js';\nimport map from './types/map.js';\nimport nan from './types/nan.js';\nimport negativeInfinity from './types/negative-infinity.js';\nimport nonbuiltinIgnore from './types/nonbuiltin-ignore.js';\nimport primitiveObjects from './types/primitive-objects.js';\nimport regexp from './types/regexp.js';\nimport resurrectable from './types/resurrectable.js';\nimport set from './types/set.js';\nimport typedArraysSocketio from './types/typed-arrays-socketio.js';\nimport typedArrays from './types/typed-arrays.js';\nimport undef from './types/undef.js';\nimport userObject from './types/user-object.js';\n\n// PRESETS\nimport arrayNonindexKeys from './presets/array-nonindex-keys.js';\nimport builtin from './presets/builtin.js';\nimport postmessage from './presets/postmessage.js';\nimport socketio from './presets/socketio.js';\nimport sparseUndefined from './presets/sparse-undefined.js';\nimport specialNumbers from './presets/special-numbers.js';\nimport structuredCloningThrowing from\n    './presets/structured-cloning-throwing.js';\nimport structuredCloning from './presets/structured-cloning.js';\nimport undefPreset from './presets/undef.js';\nimport universal from './presets/universal.js';\n\nTypeson.types = {\n    arraybuffer, bigintObject, bigint, blob, cloneable, dataview, date, error,\n    errors, file, filelist, imagebitmap, imagedata, infinity, intlTypes, map,\n    nan, negativeInfinity, nonbuiltinIgnore, primitiveObjects, regexp,\n    resurrectable, set, typedArraysSocketio, typedArrays, undef, userObject\n};\nTypeson.presets = {\n    arrayNonindexKeys, builtin, postmessage, socketio, sparseUndefined,\n    specialNumbers, structuredCloningThrowing, structuredCloning,\n    undef: undefPreset, universal\n};\n\nexport default Typeson;\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_defineProperty","_objectSpread","source","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","forEach","_slicedToArray","arr","_arrayWithHoles","Array","isArray","_iterableToArrayLimit","_arr","_n","_d","_e","_s","_i","next","push","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","arr2","_iterableToArray","iter","toString","call","from","_nonIterableSpread","TypesonPromise","f","p","toStringTag","onFulfilled","onRejected","_this","typesonResolve","typesonReject","res","r","v","map","meth","promArr","prom","hasOwn","hasOwnProperty","getProto","getPrototypeOf","fnToString","isThenable","catchCheck","isObject","val","slice","hasConstructorOf","a","b","proto","Ctor","isPlainObject","escapeKeyPathComponent","keyPathComponent","replace","unescapeKeyPathComponent","getByKeyPath","keyPath","period","indexOf","innerObj","substr","hasOwn$1","internalStateObjPropsToIgnore","nestedPathsFirst","as","keypath","match","bs","Typeson","options","plainObjectReplacers","nonplainObjectReplacers","revivers","types","_createClass","protoProps","staticProps","stringify","replacer","space","opts","stringification","encapsulated","encapsulate","JSON","stringifySync","throwOnBadSyncType","sync","stringifyAsync","parse","text","reviver","revive","parseSync","parseAsync","specialTypeNames","stateObj","returnTypeNames","rootTypeName","iterateNone","that","refObjs","refKeys","promisesDataRoot","cyclic","encapsulateObserver","ret","_encapsulate","finish","typeNames","values","getJSONType","Set","$types","$","checkPromises","_x","_x2","_checkPromises","regeneratorRuntime","mark","_callee2","promisesData","promResults","wrap","_callee2$","_context2","prev","all","pd","sent","_ref","_callee","promResult","newPromisesData","_promisesData$splice","_promisesData$splice2","prData","_prData","parentObj","detectedType","encaps","isTypesonPromise","encaps2","_callee$","_context","splice","abrupt","stop","_x3","_adaptBuiltinStateObjectProperties","ownKeysObj","cb","assign","vals","prop","tmp","resolvingTypesonPromise","observerData","$typeof","runObserver","type","awaitingTypesonPromise","includes","isNaN","Infinity","replaced","iterateIn","iterateUnsetNumeric","refIndex","cyclicKeypath","clone","isPlainObj","isArr","addLength","_loop","kp","endIterateIn","end","endIterateOwn","vl","_loop2","endIterateUnsetNumeric","plainObject","replacers","test","existing","replaceAsync","replacing","typeDetected","encapsulateSync","encapsulateAsync","keyPathResolutions","ignore$Types","_revive","_clone","k","Undefined","_keyPathResolutions$","_target","_clone2","_ret","reduce","reducer","Error","reviveAsync","checkUndefined","retrn","possibleTypesonPromise","revivePlainObjects","plainObjectTypes","entries","_ref2","_ref3","plain","sort","_ref4","setAtKeyPath","reviveSync","register","typeSpecSets","R","typeSpec","typeId","JSON_TYPES","spec","testPlainObjects","existingReplacer","Class","x","create","_spec2","replacerObj","bind","start","fallback","reviverObj","isUserObject","chars","lookup","Uint8Array","charCodeAt","encode","arraybuffer","byteOffset","byteLength","bytes","len","base64","substring","decode","encoded1","encoded2","encoded3","encoded4","bufferLength","ArrayBuffer","_i2","[object Object]","buffers","index","b64","buffer","bigintObject","BigInt","n","String","s","bigint","string2arraybuffer","str","array","blob","req","XMLHttpRequest","overrideMimeType","open","URL","createObjectURL","status","send","stringContents","responseText","Blob","isClosed","reader","FileReader","addEventListener","result","readAsBinaryString","generateUUID","d","Date","getTime","performance","now","c","Math","random","floor","cloneableObjectsByUUID","cloneable","for","clonable","uuid","dataview","encoded","b64Obj","DataView","date","dt","time","NaN","name","message","e","_global","global","errors","errName","Cnstrctr","toLowerCase","file","lastModified","File","filelist","fl","item","o","FileList","_files","get","imagebitmap","dataset","bm","canvas","document","createElement","getContext","drawImage","toDataURL","ctx","img","src","createImageBitmap","imagedata","data","width","height","ImageData","Uint8ClampedArray","infinity","intlTypes","IntlCollator","Intl","Collator","resolvedOptions","locale","IntlDateTimeFormat","DateTimeFormat","dtf","IntlNumberFormat","NumberFormat","nf","mp","Map","nan","negativeInfinity","nonbuiltinIgnore","rexp","primitiveObjects","StringObject","BooleanObject","Boolean","NumberObject","Number","regexp","flags","ignoreCase","multiline","sticky","unicode","RegExp","resurrectableObjectsByUUID","resurrectable","rsrrctble","serializedResurrectable","set","st","typedArraysSocketIO","typeName","arrType","TypedArray","buf","typedArrays","l","undef","userObject","arrayNonindexKeys","some","parseInt","sparseUndefined","specialNumbers","NegativeInfinity","expObj","postmessage","socketio","builtin","sparseArrays","structuredCloning","checkDataCloneException","stringTag","nodeType","insertBefore","DOMException","undf","universal","typedArraysSocketio","presets","structuredCloningThrowing","undefPreset"],"mappings":"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"}