!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e=e||self).Typeson=e.Typeson||{},e.Typeson.presets=e.Typeson.presets||{},e.Typeson.presets.socketio=t())}(this,function(){"use strict";var e=[{arrayNonindexKeys:{testPlainObjects:!0,test:function test(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(e){return String(parseInt(e))!==e})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function replace(e,t){return Array.isArray(e)&&(t.iterateUnsetNumeric=!0),e},revive:function revive(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(r){var n=e[r];t[r]=n}),t}}},{sparseUndefined:{test:function test(e,t){return void 0===e&&!1===t.ownKeys},replace:function replace(e){return 0},revive:function revive(e){}}}];function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"===_typeof(Symbol.iterator)?function _typeof$1(e){return _typeof(e)}:function _typeof$1(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)})(e)}function asyncGeneratorStep(e,t,r,n,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function _next(e){asyncGeneratorStep(o,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,n,i,_next,_throw,"throw",e)}_next(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}return r}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _toConsumableArray$1(e){return function _arrayWithoutHoles$1(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function _iterableToArray$1(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread$1(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var t=function TypesonPromise(e){_classCallCheck(this,TypesonPromise),this.p=new Promise(e)};"undefined"!=typeof Symbol&&(t.prototype[Symbol.toStringTag]="TypesonPromise"),t.prototype.then=function(e,r){var n=this;return new t(function(t,i){n.p.then(function(r){t(e?e(r):r)},function(e){n.p.catch(function(e){return r?r(e):Promise.reject(e)}).then(t,i)})})},t.prototype.catch=function(e){return this.then(null,e)},t.resolve=function(e){return new t(function(t){t(e)})},t.reject=function(e){return new t(function(t,r){r(e)})},["all","race"].map(function(e){t[e]=function(r){return new t(function(t,n){Promise[e](r.map(function(e){return e.p})).then(t,n)})}});var r={}.toString,n={}.hasOwnProperty,i=Object.getPrototypeOf,o=n.toString;function isThenable(e,t){return isObject(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function toStringTag(e){return r.call(e).slice(8,-1)}function hasConstructorOf(e,t){if(!e||"object"!==_typeof$1(e))return!1;var r=i(e);if(!r)return!1;var a=n.call(r,"constructor")&&r.constructor;return"function"!=typeof a?null===t:"function"==typeof a&&null!==t&&o.call(a)===o.call(t)}function isPlainObject(e){return!(!e||"Object"!==toStringTag(e))&&(!i(e)||hasConstructorOf(e,Object))}function isObject(e){return e&&"object"===_typeof$1(e)}function escapeKeyPathComponent(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function unescapeKeyPathComponent(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function getByKeyPath(e,t){if(""===t)return e;var r=t.indexOf(".");if(r>-1){var n=e[unescapeKeyPathComponent(t.substr(0,r))];return void 0===n?void 0:getByKeyPath(n,t.substr(r+1))}return e[unescapeKeyPathComponent(t)]}var a=Object.keys,c=Array.isArray,s={}.hasOwnProperty,u=["type","replaced","iterateIn","iterateUnsetNumeric"];function nestedPathsFirst(e,t){var r=e.keypath.match(/\./g),n=e.keypath.match(/\./g);return r&&(r=r.length),n&&(n=n.length),r>n?-1:r<n?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var f=function(){function Typeson(e){_classCallCheck(this,Typeson),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(Typeson,[{key:"stringify",value:function stringify(e,t,r,n){n=_objectSpread({},this.options,n,{stringification:!0});var i=this.encapsulate(e,null,n);return c(i)?JSON.stringify(i[0],t,r):i.then(function(e){return JSON.stringify(e,t,r)})}},{key:"stringifySync",value:function stringifySync(e,t,r,n){return this.stringify(e,t,r,_objectSpread({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"stringifyAsync",value:function stringifyAsync(e,t,r,n){return this.stringify(e,t,r,_objectSpread({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"parse",value:function parse(e,t,r){return r=_objectSpread({},this.options,r,{parse:!0}),this.revive(JSON.parse(e,t),r)}},{key:"parseSync",value:function parseSync(e,t,r){return this.parse(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"parseAsync",value:function parseAsync(e,t,r){return this.parse(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"specialTypeNames",value:function specialTypeNames(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.returnTypeNames=!0,this.encapsulate(e,t,r)}},{key:"rootTypeName",value:function rootTypeName(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.iterateNone=!0,this.encapsulate(e,t,r)}},{key:"encapsulate",value:function encapsulate(e,r,n){var i=(n=_objectSpread({sync:!0},this.options,n)).sync,o=this,f={},l=[],p=[],y=[],v=!("cyclic"in n)||n.cyclic,h=n.encapsulateObserver,b=_encapsulate("",e,v,r||{},y);function finish(e){var t=Object.values(f);if(n.iterateNone)return t.length?t[0]:Typeson.getJSONType(e);if(t.length){if(n.returnTypeNames)return _toConsumableArray$1(new Set(t));e&&isPlainObject(e)&&!s.call(e,"$types")?e.$types=f:e={$:e,$types:{$:f}}}else isObject(e)&&s.call(e,"$types")&&(e={$:e,$types:!0});return!n.returnTypeNames&&e}function checkPromises(e,t){return _checkPromises.apply(this,arguments)}function _checkPromises(){return(_checkPromises=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(e,r){var n;return regeneratorRuntime.wrap(function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Promise.all(r.map(function(e){return e[1].p}));case 2:return n=i.sent,i.next=5,Promise.all(n.map(function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function _callee(n){var i,o,a,c,s,u,f,l,p,y,v,h,b,d;return regeneratorRuntime.wrap(function _callee$(g){for(;;)switch(g.prev=g.next){case 0:if(i=[],o=r.splice(0,1),a=_slicedToArray(o,1),c=a[0],s=_slicedToArray(c,7),u=s[0],f=s[2],l=s[3],p=s[4],y=s[5],v=s[6],h=_encapsulate(u,n,f,l,i,!0,v),b=hasConstructorOf(h,t),!u||!b){g.next=11;break}return g.next=8,h.p;case 8:return d=g.sent,p[y]=d,g.abrupt("return",checkPromises(e,i));case 11:return u?p[y]=h:e=b?h.p:h,g.abrupt("return",checkPromises(e,i));case 13:case"end":return g.stop()}},_callee)}));return function(e){return n.apply(this,arguments)}}()));case 5:return i.abrupt("return",e);case 6:case"end":return i.stop()}},_callee2)}))).apply(this,arguments)}function _adaptBuiltinStateObjectProperties(e,t,r){Object.assign(e,t);var n=u.map(function(t){var r=e[t];return delete e[t],r});r(),u.forEach(function(t,r){e[t]=n[r]})}function _encapsulate(e,r,i,u,y,v,b){var d,g={},m=_typeof$1(r),O=h?function(n){var o=b||u.type||Typeson.getJSONType(r);h(Object.assign(n||g,{keypath:e,value:r,cyclic:i,stateObj:u,promisesData:y,resolvingTypesonPromise:v,awaitingTypesonPromise:hasConstructorOf(r,t)},void 0!==o?{type:o}:{}))}:null;if(["string","boolean","number","undefined"].includes(m))return void 0===r||"number"===m&&(isNaN(r)||r===-1/0||r===1/0)?(d=replace(e,r,u,y,!1,v,O))!==r&&(g={replaced:d}):d=r,O&&O(),d;if(null===r)return O&&O(),r;if(i&&!u.iterateIn&&!u.iterateUnsetNumeric){var S=l.indexOf(r);if(!(S<0))return f[e]="#",O&&O({cyclicKeypath:p[S]}),"#"+p[S];!0===i&&(l.push(r),p.push(e))}var _,w=isPlainObject(r),A=c(r),j=(w||A)&&(!o.plainObjectReplacers.length||u.replaced)||u.iterateIn?r:replace(e,r,u,y,w||A,null,O);if(j!==r?(d=j,g={replaced:j}):A&&"object"!==u.iterateIn||"array"===u.iterateIn?(_=new Array(r.length),g={clone:_}):w||"object"===u.iterateIn?(_={},u.addLength&&(_.length=r.length),g={clone:_}):""===e&&hasConstructorOf(r,t)?(y.push([e,r,i,u,void 0,void 0,u.type]),d=r):d=r,O&&O(),n.iterateNone)return _||d;if(!_)return d;if(u.iterateIn){var T=function _loop(n){var o={ownKeys:s.call(r,n)};_adaptBuiltinStateObjectProperties(u,o,function(){var o=e+(e?".":"")+escapeKeyPathComponent(n),a=_encapsulate(o,r[n],!!i,u,y,v);hasConstructorOf(a,t)?y.push([o,a,!!i,u,_,n,u.type]):void 0!==a&&(_[n]=a)})};for(var P in r)T(P);O&&O({endIterateIn:!0,end:!0})}else a(r).forEach(function(n){var o=e+(e?".":"")+escapeKeyPathComponent(n);_adaptBuiltinStateObjectProperties(u,{ownKeys:!0},function(){var e=_encapsulate(o,r[n],!!i,u,y,v);hasConstructorOf(e,t)?y.push([o,e,!!i,u,_,n,u.type]):void 0!==e&&(_[n]=e)})}),O&&O({endIterateOwn:!0,end:!0});if(u.iterateUnsetNumeric){for(var C=r.length,k=function _loop2(n){if(!(n in r)){var o=e+(e?".":"")+n;_adaptBuiltinStateObjectProperties(u,{ownKeys:!1},function(){var e=_encapsulate(o,void 0,!!i,u,y,v);hasConstructorOf(e,t)?y.push([o,e,!!i,u,_,n,u.type]):void 0!==e&&(_[n]=e)})}},N=0;N<C;N++)k(N);O&&O({endIterateUnsetNumeric:!0,end:!0})}return _}function replace(e,t,r,n,a,c,s){for(var u=a?o.plainObjectReplacers:o.nonplainObjectReplacers,l=u.length;l--;){var p=u[l];if(p.test(t,r)){var y=p.type;if(o.revivers[y]){var h=f[e];f[e]=h?[y].concat(h):y}return Object.assign(r,{type:y,replaced:!0}),!i&&p.replaceAsync||p.replace?(s&&s({replacing:!0}),_encapsulate(e,p[i||!p.replaceAsync?"replace":"replaceAsync"](t,r),v&&"readonly",r,n,c,y)):(s&&s({typeDetected:!0}),_encapsulate(e,t,v&&"readonly",r,n,c,y))}}return t}return y.length?i&&n.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(checkPromises(b,y)).then(finish):!i&&n.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():n.stringification&&i?[finish(b)]:i?finish(b):Promise.resolve(finish(b))}},{key:"encapsulateSync",value:function encapsulateSync(e,t,r){return this.encapsulate(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"encapsulateAsync",value:function encapsulateAsync(e,t,r){return this.encapsulate(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"revive",value:function revive(e,r){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var i=(r=_objectSpread({sync:!0},this.options,r)).sync,o=[],s={},u=!0;n.$&&isPlainObject(n.$)&&(e=e.$,n=n.$,u=!1);var f=this;function _revive(e,r,p,y,v){if(!u||"$types"!==e){var h=n[e];if(c(r)||isPlainObject(r)){var b=c(r)?new Array(r.length):{};for(a(r).forEach(function(t){var n=_revive(e+(e?".":"")+escapeKeyPathComponent(t),r[t],p||b,b,t);hasConstructorOf(n,l)?b[t]=void 0:void 0!==n&&(b[t]=n)}),r=b;o.length;){var d=_slicedToArray(o[0],4),g=d[0],m=d[1],O=d[2],S=d[3],_=getByKeyPath(g,m);if(hasConstructorOf(_,l))O[S]=void 0;else{if(void 0===_)break;O[S]=_}o.splice(0,1)}}if(!h)return r;if("#"===h){var w=getByKeyPath(p,r.slice(1));return void 0===w&&o.push([p,r.slice(1),y,v]),w}return[].concat(h).reduce(function reducer(e,r){if(hasConstructorOf(e,t))return e.then(function(e){return reducer(e,r)});var n=_slicedToArray(f.revivers[r],1)[0];if(!n)throw new Error("Unregistered type: "+r);return n[i&&n.revive?"revive":!i&&n.reviveAsync?"reviveAsync":"revive"](e,s)},r)}}function checkUndefined(e){return hasConstructorOf(e,l)?void 0:e}var p,y=function revivePlainObjects(){var r=[];if(Object.entries(n).forEach(function(e){var t=_slicedToArray(e,2),i=t[0],o=t[1];"#"!==o&&[].concat(o).forEach(function(e){_slicedToArray(f.revivers[e],2)[1].plain&&(r.push({keypath:i,type:e}),delete n[i])})}),r.length)return r.sort(nestedPathsFirst).reduce(function reducer(r,n){var o=n.keypath,a=n.type;if(hasConstructorOf(r,t))return r.then(function(e){return reducer(e,a)});var c=getByKeyPath(e,o);if(hasConstructorOf(c,t))return c.then(function(e){return reducer(e,a)});var u=_slicedToArray(f.revivers[a],1)[0];if(!u)throw new Error("Unregistered type: "+a);void 0!==(c=u[i&&u.revive?"revive":!i&&u.reviveAsync?"reviveAsync":"revive"](c,s))&&(hasConstructorOf(c,l)&&(c=void 0),function setAtKeyPath(e,t,r){if(""===t)return r;var n=t.indexOf(".");return n>-1?setAtKeyPath(e[unescapeKeyPathComponent(t.substr(0,n))],t.substr(n+1),r):(e[unescapeKeyPathComponent(t)]=r,e)}(e,o,c)===c&&(e=c))},void 0)}();return isThenable(p=hasConstructorOf(y,t)?y.then(function(){return _revive("",e,null)}):_revive("",e,null))?i&&r.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():hasConstructorOf(p,t)?p.p.then(checkUndefined):p:!i&&r.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():i?checkUndefined(p):Promise.resolve(checkUndefined(p))}},{key:"reviveSync",value:function reviveSync(e,t){return this.revive(e,_objectSpread({throwOnBadSyncType:!0},t,{sync:!0}))}},{key:"reviveAsync",value:function reviveAsync(e,t){return this.revive(e,_objectSpread({throwOnBadSyncType:!0},t,{sync:!1}))}},{key:"register",value:function register(e,t){return t=t||{},[].concat(e).forEach(function R(e){if(c(e))return e.map(R,this);e&&a(e).forEach(function(r){if("#"===r)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(Typeson.JSON_TYPES.includes(r))throw new TypeError("Plain JSON object types are reserved as type names");var n=e[r],i=n.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,o=i.filter(function(e){return e.type===r});if(o.length&&(i.splice(i.indexOf(o[0]),1),delete this.revivers[r],delete this.types[r]),n){if("function"==typeof n){var a=n;n={test:function test(e){return e&&e.constructor===a},replace:function replace(e){return Object.assign({},e)},revive:function revive(e){return Object.assign(Object.create(a.prototype),e)}}}else if(c(n)){var s=_slicedToArray(n,3);n={test:s[0],replace:s[1],revive:s[2]}}var u={type:r,test:n.test.bind(n)};n.replace&&(u.replace=n.replace.bind(n)),n.replaceAsync&&(u.replaceAsync=n.replaceAsync.bind(n));var f="number"==typeof t.fallback?t.fallback:t.fallback?0:1/0;if(n.testPlainObjects?this.plainObjectReplacers.splice(f,0,u):this.nonplainObjectReplacers.splice(f,0,u),n.revive||n.reviveAsync){var l={};n.revive&&(l.revive=n.revive.bind(n)),n.reviveAsync&&(l.reviveAsync=n.reviveAsync.bind(n)),this.revivers[r]=[l,{plain:n.testPlainObjects}]}this.types[r]=n}},this)},this),this}}]),Typeson}(),l=function Undefined(){_classCallCheck(this,Undefined)};f.Undefined=l,f.Promise=t,f.isThenable=isThenable,f.toStringTag=toStringTag,f.hasConstructorOf=hasConstructorOf,f.isObject=isObject,f.isPlainObject=isPlainObject,f.isUserObject=function isUserObject(e){if(!e||"Object"!==toStringTag(e))return!1;var t=i(e);return!t||hasConstructorOf(e,Object)||isUserObject(t)},f.escapeKeyPathComponent=escapeKeyPathComponent,f.unescapeKeyPathComponent=unescapeKeyPathComponent,f.getByKeyPath=getByKeyPath,f.getJSONType=function getJSONType(e){return null===e?"null":Array.isArray(e)?"array":_typeof$1(e)},f.JSON_TYPES=["null","boolean","number","string","array","object"];var p={undef:{test:function test(e,t){return void 0===e&&(t.ownKeys||!("ownKeys"in t))},replace:function replace(e){return 0},revive:function revive(e){return new f.Undefined}}},y={StringObject:{test:function test(e){return"String"===f.toStringTag(e)&&"object"===_typeof(e)},replace:function replace(e){return String(e)},revive:function revive(e){return new String(e)}},BooleanObject:{test:function test(e){return"Boolean"===f.toStringTag(e)&&"object"===_typeof(e)},replace:function replace(e){return Boolean(e)},revive:function revive(e){return new Boolean(e)}},NumberObject:{test:function test(e){return"Number"===f.toStringTag(e)&&"object"===_typeof(e)},replace:function replace(e){return Number(e)},revive:function revive(e){return new Number(e)}}},v=[{nan:{test:function test(e){return"number"==typeof e&&isNaN(e)},replace:function replace(e){return"NaN"},revive:function revive(e){return NaN}}},{infinity:{test:function test(e){return e===1/0},replace:function replace(e){return"Infinity"},revive:function revive(e){return 1/0}}},{negativeInfinity:{test:function test(e){return e===-1/0},replace:function replace(e){return"-Infinity"},revive:function revive(e){return-1/0}}}],h={date:{test:function test(e){return"Date"===f.toStringTag(e)},replace:function replace(e){var t=e.getTime();return isNaN(t)?"NaN":t},revive:function revive(e){return"NaN"===e?new Date(NaN):new Date(e)}}},b={error:{test:function test(e){return"Error"===f.toStringTag(e)},replace:function replace(e){return{name:e.name,message:e.message}},revive:function revive(e){var t=e.name,r=e.message,n=new Error(r);return n.name=t,n}}},d="undefined"==typeof self?global:self,g={};["TypeError","RangeError","SyntaxError","ReferenceError","EvalError","URIError","InternalError"].forEach(function(e){var t=d[e];t&&(g[e.toLowerCase()]={test:function test(e){return f.hasConstructorOf(e,t)},replace:function replace(e){return e.message},revive:function revive(e){return new t(e)}})});for(var m={regexp:{test:function test(e){return"RegExp"===f.toStringTag(e)},replace:function replace(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function revive(e){var t=e.source,r=e.flags;return new RegExp(t,r)}}},O={map:{test:function test(e){return"Map"===f.toStringTag(e)},replace:function replace(e){return _toConsumableArray(e.entries())},revive:function revive(e){return new Map(e)}}},S={set:{test:function test(e){return"Set"===f.toStringTag(e)},replace:function replace(e){return _toConsumableArray(e.values())},revive:function revive(e){return new Set(e)}}},_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=new Uint8Array(256),A=0;A<_.length;A++)w[_.charCodeAt(A)]=A;var j=function encode(e,t,r){null==r&&(r=e.byteLength);for(var n=new Uint8Array(e,t||0,r),i=n.length,o="",a=0;a<i;a+=3)o+=_[n[a]>>2],o+=_[(3&n[a])<<4|n[a+1]>>4],o+=_[(15&n[a+1])<<2|n[a+2]>>6],o+=_[63&n[a+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},T=function decode(e){var t,r,n,i,o=e.length,a=.75*e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);for(var s=new ArrayBuffer(a),u=new Uint8Array(s),f=0;f<o;f+=4)t=w[e.charCodeAt(f)],r=w[e.charCodeAt(f+1)],n=w[e.charCodeAt(f+2)],i=w[e.charCodeAt(f+3)],u[c++]=t<<2|r>>4,u[c++]=(15&r)<<4|n>>2,u[c++]=(3&n)<<6|63&i;return s},P={arraybuffer:{test:function test(e){return"ArrayBuffer"===f.toStringTag(e)},replace:function replace(e,t){t.buffers||(t.buffers=[]);var r=t.buffers.indexOf(e);return r>-1?{index:r}:(t.buffers.push(e),j(e))},revive:function revive(e,t){if(t.buffers||(t.buffers=[]),"object"===_typeof(e))return t.buffers[e.index];var r=T(e);return t.buffers.push(r),r}}},C="undefined"==typeof self?global:self,k={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){var t=e,r=C[t];r&&(k[e.toLowerCase()]={test:function test(e){return f.toStringTag(e)===t},replace:function replace(e,t){var r=e.buffer,n=e.byteOffset,i=e.length;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(r);return o>-1?{index:o,byteOffset:n,length:i}:(t.buffers.push(r),{encoded:j(r),byteOffset:n,length:i})},revive:function revive(e,t){t.buffers||(t.buffers=[]);var n,i=e.byteOffset,o=e.length,a=e.encoded,c=e.index;return"index"in e?n=t.buffers[c]:(n=T(a),t.buffers.push(n)),new r(n,i,o)}})});var N={dataview:{test:function test(e){return"DataView"===f.toStringTag(e)},replace:function replace(e,t){var r=e.buffer,n=e.byteOffset,i=e.byteLength;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(r);return o>-1?{index:o,byteOffset:n,byteLength:i}:(t.buffers.push(r),{encoded:j(r),byteOffset:n,byteLength:i})},revive:function revive(e,t){t.buffers||(t.buffers=[]);var r,n=e.byteOffset,i=e.byteLength,o=e.encoded,a=e.index;return"index"in e?r=t.buffers[a]:(r=T(o),t.buffers.push(r)),new DataView(r,n,i)}}},I={test:function test(e){return f.hasConstructorOf(e,Intl.Collator)},replace:function replace(e){return e.resolvedOptions()},revive:function revive(e){return new Intl.Collator(e.locale,e)}},E={test:function test(e){return f.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function replace(e){return e.resolvedOptions()},revive:function revive(e){return new Intl.DateTimeFormat(e.locale,e)}},B={test:function test(e){return f.hasConstructorOf(e,Intl.NumberFormat)},replace:function replace(e){return e.resolvedOptions()},revive:function revive(e){return new Intl.NumberFormat(e.locale,e)}},x={bigint:{test:function test(e){return"bigint"==typeof e},replace:function replace(e){return String(e)},revive:function revive(e){return BigInt(e)}}},U={bigintObject:{test:function test(e){return"object"===_typeof(e)&&f.hasConstructorOf(e,BigInt)},replace:function replace(e){return String(e)},revive:function revive(e){return new Object(BigInt(e))}}},K=[p,e,y,v,h,b,g,m].concat("function"==typeof Map?O:[],"function"==typeof Set?S:[],"function"==typeof ArrayBuffer?P:[],"function"==typeof Uint8Array?k:[],"function"==typeof DataView?N:[],"undefined"!=typeof Intl?{IntlCollator:I,IntlDateTimeFormat:E,IntlNumberFormat:B}:[],"undefined"!=typeof BigInt?[x,U]:[]),$="undefined"==typeof self?global:self,L={};return["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){var t=e,r=$[e];r&&(L[e.toLowerCase()]={test:function test(e){return f.toStringTag(e)===t},replace:function replace(e){return(0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e:e.slice(0)).buffer},revive:function revive(e){return"ArrayBuffer"===f.toStringTag(e)?new r(e):e}})}),[K,{ArrayBuffer:null},L]});
//# sourceMappingURL=socketio.js.map
