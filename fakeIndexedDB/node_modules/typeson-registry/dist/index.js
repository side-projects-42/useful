function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(i,n,a,_next,_throw,"throw",e)}_next(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var e=function TypesonPromise(e){_classCallCheck(this,TypesonPromise),this.p=new Promise(e)};"undefined"!=typeof Symbol&&(e.prototype[Symbol.toStringTag]="TypesonPromise"),e.prototype.then=function(t,r){var n=this;return new e(function(e,a){n.p.then(function(r){e(t?t(r):r)},function(t){n.p.catch(function(e){return r?r(e):Promise.reject(e)}).then(e,a)})})},e.prototype.catch=function(e){return this.then(null,e)},e.resolve=function(t){return new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,r){r(t)})},["all","race"].map(function(t){e[t]=function(r){return new e(function(e,n){Promise[t](r.map(function(e){return e.p})).then(e,n)})}});var t={}.toString,r={}.hasOwnProperty,n=Object.getPrototypeOf,a=r.toString;function isThenable(e,t){return isObject(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function toStringTag(e){return t.call(e).slice(8,-1)}function hasConstructorOf(e,t){if(!e||"object"!==_typeof(e))return!1;var i=n(e);if(!i)return!1;var o=r.call(i,"constructor")&&i.constructor;return"function"!=typeof o?null===t:"function"==typeof o&&null!==t&&a.call(o)===a.call(t)}function isPlainObject(e){return!(!e||"Object"!==toStringTag(e))&&(!n(e)||hasConstructorOf(e,Object))}function isObject(e){return e&&"object"===_typeof(e)}function escapeKeyPathComponent(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function unescapeKeyPathComponent(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function getByKeyPath(e,t){if(""===t)return e;var r=t.indexOf(".");if(r>-1){var n=e[unescapeKeyPathComponent(t.substr(0,r))];return void 0===n?void 0:getByKeyPath(n,t.substr(r+1))}return e[unescapeKeyPathComponent(t)]}var i=Object.keys,o=Array.isArray,s={}.hasOwnProperty,c=["type","replaced","iterateIn","iterateUnsetNumeric"];function nestedPathsFirst(e,t){var r=e.keypath.match(/\./g),n=e.keypath.match(/\./g);return r&&(r=r.length),n&&(n=n.length),r>n?-1:r<n?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var u=function(){function Typeson(e){_classCallCheck(this,Typeson),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(Typeson,[{key:"stringify",value:function stringify(e,t,r,n){n=_objectSpread({},this.options,n,{stringification:!0});var a=this.encapsulate(e,null,n);return o(a)?JSON.stringify(a[0],t,r):a.then(function(e){return JSON.stringify(e,t,r)})}},{key:"stringifySync",value:function stringifySync(e,t,r,n){return this.stringify(e,t,r,_objectSpread({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"stringifyAsync",value:function stringifyAsync(e,t,r,n){return this.stringify(e,t,r,_objectSpread({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"parse",value:function parse(e,t,r){return r=_objectSpread({},this.options,r,{parse:!0}),this.revive(JSON.parse(e,t),r)}},{key:"parseSync",value:function parseSync(e,t,r){return this.parse(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"parseAsync",value:function parseAsync(e,t,r){return this.parse(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"specialTypeNames",value:function specialTypeNames(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.returnTypeNames=!0,this.encapsulate(e,t,r)}},{key:"rootTypeName",value:function rootTypeName(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.iterateNone=!0,this.encapsulate(e,t,r)}},{key:"encapsulate",value:function encapsulate(t,r,n){var a=(n=_objectSpread({sync:!0},this.options,n)).sync,u=this,l={},f=[],y=[],p=[],v=!("cyclic"in n)||n.cyclic,d=n.encapsulateObserver,h=_encapsulate("",t,v,r||{},p);function finish(e){var t=Object.values(l);if(n.iterateNone)return t.length?t[0]:Typeson.getJSONType(e);if(t.length){if(n.returnTypeNames)return _toConsumableArray(new Set(t));e&&isPlainObject(e)&&!s.call(e,"$types")?e.$types=l:e={$:e,$types:{$:l}}}else isObject(e)&&s.call(e,"$types")&&(e={$:e,$types:!0});return!n.returnTypeNames&&e}function checkPromises(e,t){return _checkPromises.apply(this,arguments)}function _checkPromises(){return(_checkPromises=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(t,r){var n;return regeneratorRuntime.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(r.map(function(e){return e[1].p}));case 2:return n=a.sent,a.next=5,Promise.all(n.map(function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function _callee(n){var a,i,o,s,c,u,l,f,y,p,v,d,h,b;return regeneratorRuntime.wrap(function _callee$(g){for(;;)switch(g.prev=g.next){case 0:if(a=[],i=r.splice(0,1),o=_slicedToArray(i,1),s=o[0],c=_slicedToArray(s,7),u=c[0],l=c[2],f=c[3],y=c[4],p=c[5],v=c[6],d=_encapsulate(u,n,l,f,a,!0,v),h=hasConstructorOf(d,e),!u||!h){g.next=11;break}return g.next=8,d.p;case 8:return b=g.sent,y[p]=b,g.abrupt("return",checkPromises(t,a));case 11:return u?y[p]=d:t=h?d.p:d,g.abrupt("return",checkPromises(t,a));case 13:case"end":return g.stop()}},_callee)}));return function(e){return n.apply(this,arguments)}}()));case 5:return a.abrupt("return",t);case 6:case"end":return a.stop()}},_callee2)}))).apply(this,arguments)}function _adaptBuiltinStateObjectProperties(e,t,r){Object.assign(e,t);var n=c.map(function(t){var r=e[t];return delete e[t],r});r(),c.forEach(function(t,r){e[t]=n[r]})}function _encapsulate(t,r,a,c,p,v,h){var b,g={},m=_typeof(r),O=d?function(n){var i=h||c.type||Typeson.getJSONType(r);d(Object.assign(n||g,{keypath:t,value:r,cyclic:a,stateObj:c,promisesData:p,resolvingTypesonPromise:v,awaitingTypesonPromise:hasConstructorOf(r,e)},void 0!==i?{type:i}:{}))}:null;if(["string","boolean","number","undefined"].includes(m))return void 0===r||"number"===m&&(isNaN(r)||r===-1/0||r===1/0)?(b=replace(t,r,c,p,!1,v,O))!==r&&(g={replaced:b}):b=r,O&&O(),b;if(null===r)return O&&O(),r;if(a&&!c.iterateIn&&!c.iterateUnsetNumeric){var w=f.indexOf(r);if(!(w<0))return l[t]="#",O&&O({cyclicKeypath:y[w]}),"#"+y[w];!0===a&&(f.push(r),y.push(t))}var S,A=isPlainObject(r),T=o(r),j=(A||T)&&(!u.plainObjectReplacers.length||c.replaced)||c.iterateIn?r:replace(t,r,c,p,A||T,null,O);if(j!==r?(b=j,g={replaced:j}):T&&"object"!==c.iterateIn||"array"===c.iterateIn?(S=new Array(r.length),g={clone:S}):A||"object"===c.iterateIn?(S={},c.addLength&&(S.length=r.length),g={clone:S}):""===t&&hasConstructorOf(r,e)?(p.push([t,r,a,c,void 0,void 0,c.type]),b=r):b=r,O&&O(),n.iterateNone)return S||b;if(!S)return b;if(c.iterateIn){var _=function _loop(n){var i={ownKeys:s.call(r,n)};_adaptBuiltinStateObjectProperties(c,i,function(){var i=t+(t?".":"")+escapeKeyPathComponent(n),o=_encapsulate(i,r[n],!!a,c,p,v);hasConstructorOf(o,e)?p.push([i,o,!!a,c,S,n,c.type]):void 0!==o&&(S[n]=o)})};for(var C in r)_(C);O&&O({endIterateIn:!0,end:!0})}else i(r).forEach(function(n){var i=t+(t?".":"")+escapeKeyPathComponent(n);_adaptBuiltinStateObjectProperties(c,{ownKeys:!0},function(){var t=_encapsulate(i,r[n],!!a,c,p,v);hasConstructorOf(t,e)?p.push([i,t,!!a,c,S,n,c.type]):void 0!==t&&(S[n]=t)})}),O&&O({endIterateOwn:!0,end:!0});if(c.iterateUnsetNumeric){for(var P=r.length,x=function _loop2(n){if(!(n in r)){var i=t+(t?".":"")+n;_adaptBuiltinStateObjectProperties(c,{ownKeys:!1},function(){var t=_encapsulate(i,void 0,!!a,c,p,v);hasConstructorOf(t,e)?p.push([i,t,!!a,c,S,n,c.type]):void 0!==t&&(S[n]=t)})}},I=0;I<P;I++)x(I);O&&O({endIterateUnsetNumeric:!0,end:!0})}return S}function replace(e,t,r,n,i,o,s){for(var c=i?u.plainObjectReplacers:u.nonplainObjectReplacers,f=c.length;f--;){var y=c[f];if(y.test(t,r)){var p=y.type;if(u.revivers[p]){var d=l[e];l[e]=d?[p].concat(d):p}return Object.assign(r,{type:p,replaced:!0}),!a&&y.replaceAsync||y.replace?(s&&s({replacing:!0}),_encapsulate(e,y[a||!y.replaceAsync?"replace":"replaceAsync"](t,r),v&&"readonly",r,n,o,p)):(s&&s({typeDetected:!0}),_encapsulate(e,t,v&&"readonly",r,n,o,p))}}return t}return p.length?a&&n.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(checkPromises(h,p)).then(finish):!a&&n.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():n.stringification&&a?[finish(h)]:a?finish(h):Promise.resolve(finish(h))}},{key:"encapsulateSync",value:function encapsulateSync(e,t,r){return this.encapsulate(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"encapsulateAsync",value:function encapsulateAsync(e,t,r){return this.encapsulate(e,t,_objectSpread({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"revive",value:function revive(t,r){var n=t&&t.$types;if(!n)return t;if(!0===n)return t.$;var a=(r=_objectSpread({sync:!0},this.options,r)).sync,s=[],c={},u=!0;n.$&&isPlainObject(n.$)&&(t=t.$,n=n.$,u=!1);var f=this;function _revive(t,r,y,p,v){if(!u||"$types"!==t){var d=n[t];if(o(r)||isPlainObject(r)){var h=o(r)?new Array(r.length):{};for(i(r).forEach(function(e){var n=_revive(t+(t?".":"")+escapeKeyPathComponent(e),r[e],y||h,h,e);hasConstructorOf(n,l)?h[e]=void 0:void 0!==n&&(h[e]=n)}),r=h;s.length;){var b=_slicedToArray(s[0],4),g=b[0],m=b[1],O=b[2],w=b[3],S=getByKeyPath(g,m);if(hasConstructorOf(S,l))O[w]=void 0;else{if(void 0===S)break;O[w]=S}s.splice(0,1)}}if(!d)return r;if("#"===d){var A=getByKeyPath(y,r.slice(1));return void 0===A&&s.push([y,r.slice(1),p,v]),A}return[].concat(d).reduce(function reducer(t,r){if(hasConstructorOf(t,e))return t.then(function(e){return reducer(e,r)});var n=_slicedToArray(f.revivers[r],1)[0];if(!n)throw new Error("Unregistered type: "+r);return n[a&&n.revive?"revive":!a&&n.reviveAsync?"reviveAsync":"revive"](t,c)},r)}}function checkUndefined(e){return hasConstructorOf(e,l)?void 0:e}var y,p=function revivePlainObjects(){var r=[];if(Object.entries(n).forEach(function(e){var t=_slicedToArray(e,2),a=t[0],i=t[1];"#"!==i&&[].concat(i).forEach(function(e){_slicedToArray(f.revivers[e],2)[1].plain&&(r.push({keypath:a,type:e}),delete n[a])})}),r.length)return r.sort(nestedPathsFirst).reduce(function reducer(r,n){var i=n.keypath,o=n.type;if(hasConstructorOf(r,e))return r.then(function(e){return reducer(e,o)});var s=getByKeyPath(t,i);if(hasConstructorOf(s,e))return s.then(function(e){return reducer(e,o)});var u=_slicedToArray(f.revivers[o],1)[0];if(!u)throw new Error("Unregistered type: "+o);void 0!==(s=u[a&&u.revive?"revive":!a&&u.reviveAsync?"reviveAsync":"revive"](s,c))&&(hasConstructorOf(s,l)&&(s=void 0),function setAtKeyPath(e,t,r){if(""===t)return r;var n=t.indexOf(".");return n>-1?setAtKeyPath(e[unescapeKeyPathComponent(t.substr(0,n))],t.substr(n+1),r):(e[unescapeKeyPathComponent(t)]=r,e)}(t,i,s)===s&&(t=s))},void 0)}();return isThenable(y=hasConstructorOf(p,e)?p.then(function(){return _revive("",t,null)}):_revive("",t,null))?a&&r.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():hasConstructorOf(y,e)?y.p.then(checkUndefined):y:!a&&r.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a?checkUndefined(y):Promise.resolve(checkUndefined(y))}},{key:"reviveSync",value:function reviveSync(e,t){return this.revive(e,_objectSpread({throwOnBadSyncType:!0},t,{sync:!0}))}},{key:"reviveAsync",value:function reviveAsync(e,t){return this.revive(e,_objectSpread({throwOnBadSyncType:!0},t,{sync:!1}))}},{key:"register",value:function register(e,t){return t=t||{},[].concat(e).forEach(function R(e){if(o(e))return e.map(R,this);e&&i(e).forEach(function(r){if("#"===r)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(Typeson.JSON_TYPES.includes(r))throw new TypeError("Plain JSON object types are reserved as type names");var n=e[r],a=n.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,i=a.filter(function(e){return e.type===r});if(i.length&&(a.splice(a.indexOf(i[0]),1),delete this.revivers[r],delete this.types[r]),n){if("function"==typeof n){var s=n;n={test:function test(e){return e&&e.constructor===s},replace:function replace(e){return Object.assign({},e)},revive:function revive(e){return Object.assign(Object.create(s.prototype),e)}}}else if(o(n)){var c=_slicedToArray(n,3);n={test:c[0],replace:c[1],revive:c[2]}}var u={type:r,test:n.test.bind(n)};n.replace&&(u.replace=n.replace.bind(n)),n.replaceAsync&&(u.replaceAsync=n.replaceAsync.bind(n));var l="number"==typeof t.fallback?t.fallback:t.fallback?0:1/0;if(n.testPlainObjects?this.plainObjectReplacers.splice(l,0,u):this.nonplainObjectReplacers.splice(l,0,u),n.revive||n.reviveAsync){var f={};n.revive&&(f.revive=n.revive.bind(n)),n.reviveAsync&&(f.reviveAsync=n.reviveAsync.bind(n)),this.revivers[r]=[f,{plain:n.testPlainObjects}]}this.types[r]=n}},this)},this),this}}]),Typeson}(),l=function Undefined(){_classCallCheck(this,Undefined)};u.Undefined=l,u.Promise=e,u.isThenable=isThenable,u.toStringTag=toStringTag,u.hasConstructorOf=hasConstructorOf,u.isObject=isObject,u.isPlainObject=isPlainObject,u.isUserObject=function isUserObject(e){if(!e||"Object"!==toStringTag(e))return!1;var t=n(e);return!t||hasConstructorOf(e,Object)||isUserObject(t)},u.escapeKeyPathComponent=escapeKeyPathComponent,u.unescapeKeyPathComponent=unescapeKeyPathComponent,u.getByKeyPath=getByKeyPath,u.getJSONType=function getJSONType(e){return null===e?"null":Array.isArray(e)?"array":_typeof(e)},u.JSON_TYPES=["null","boolean","number","string","array","object"];for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=new Uint8Array(256),p=0;p<f.length;p++)y[f.charCodeAt(p)]=p;var v=function encode(e,t,r){null==r&&(r=e.byteLength);for(var n=new Uint8Array(e,t||0,r),a=n.length,i="",o=0;o<a;o+=3)i+=f[n[o]>>2],i+=f[(3&n[o])<<4|n[o+1]>>4],i+=f[(15&n[o+1])<<2|n[o+2]>>6],i+=f[63&n[o+2]];return a%3==2?i=i.substring(0,i.length-1)+"=":a%3==1&&(i=i.substring(0,i.length-2)+"=="),i},d=function decode(e){var t,r,n,a,i=e.length,o=.75*e.length,s=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);for(var c=new ArrayBuffer(o),u=new Uint8Array(c),l=0;l<i;l+=4)t=y[e.charCodeAt(l)],r=y[e.charCodeAt(l+1)],n=y[e.charCodeAt(l+2)],a=y[e.charCodeAt(l+3)],u[s++]=t<<2|r>>4,u[s++]=(15&r)<<4|n>>2,u[s++]=(3&n)<<6|63&a;return c};const h={arraybuffer:{test:e=>"ArrayBuffer"===u.toStringTag(e),replace(e,t){t.buffers||(t.buffers=[]);const r=t.buffers.indexOf(e);return r>-1?{index:r}:(t.buffers.push(e),v(e))},revive(e,t){if(t.buffers||(t.buffers=[]),"object"==typeof e)return t.buffers[e.index];const r=d(e);return t.buffers.push(r),r}}},b={bigintObject:{test:e=>"object"==typeof e&&u.hasConstructorOf(e,BigInt),replace:e=>String(e),revive:e=>new Object(BigInt(e))}},g={bigint:{test:e=>"bigint"==typeof e,replace:e=>String(e),revive:e=>BigInt(e)}};function string2arraybuffer(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t.buffer}const m={blob:{test:e=>"Blob"===u.toStringTag(e),replace(e){const t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return t.send(),{type:e.type,stringContents:t.responseText}},revive:({type:e,stringContents:t})=>new Blob([string2arraybuffer(t)],{type:e}),replaceAsync:e=>new u.Promise((t,r)=>{if(e.isClosed)return void r(new Error("The Blob is closed"));const n=new FileReader;n.addEventListener("load",()=>{t({type:e.type,stringContents:n.result})}),n.addEventListener("error",()=>{r(n.error)}),n.readAsBinaryString(e)})}};function generateUUID(){let e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,function(t){const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})}const O={},w={cloneable:{test:e=>e&&"object"==typeof e&&"function"==typeof e[Symbol.for("cloneEncapsulate")],replace(e){const t=e[Symbol.for("cloneEncapsulate")](),r=generateUUID();return O[r]=e,{uuid:r,encapsulated:t}},revive:({uuid:e,encapsulated:t})=>O[e][Symbol.for("cloneRevive")](t)}},S={dataview:{test:e=>"DataView"===u.toStringTag(e),replace({buffer:e,byteOffset:t,byteLength:r},n){n.buffers||(n.buffers=[]);const a=n.buffers.indexOf(e);return a>-1?{index:a,byteOffset:t,byteLength:r}:(n.buffers.push(e),{encoded:v(e),byteOffset:t,byteLength:r})},revive(e,t){t.buffers||(t.buffers=[]);const{byteOffset:r,byteLength:n,encoded:a,index:i}=e;let o;return"index"in e?o=t.buffers[i]:(o=d(a),t.buffers.push(o)),new DataView(o,r,n)}}},A={date:{test:e=>"Date"===u.toStringTag(e),replace(e){const t=e.getTime();return isNaN(t)?"NaN":t},revive:e=>"NaN"===e?new Date(NaN):new Date(e)}},T={error:{test:e=>"Error"===u.toStringTag(e),replace:({name:e,message:t})=>({name:e,message:t}),revive({name:e,message:t}){const r=new Error(t);return r.name=e,r}}},j="undefined"==typeof self?global:self,_={};["TypeError","RangeError","SyntaxError","ReferenceError","EvalError","URIError","InternalError"].forEach(e=>{const t=j[e];t&&(_[e.toLowerCase()]={test:e=>u.hasConstructorOf(e,t),replace:e=>e.message,revive:e=>new t(e)})});const C={file:{test:e=>"File"===u.toStringTag(e),replace(e){const t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return t.send(),{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:({name:e,type:t,stringContents:r,lastModified:n})=>new File([string2arraybuffer(r)],e,{type:t,lastModified:n}),replaceAsync:e=>new u.Promise(function(t,r){if(e.isClosed)return void r(new Error("The File is closed"));const n=new FileReader;n.addEventListener("load",function(){t({type:e.type,stringContents:n.result,name:e.name,lastModified:e.lastModified})}),n.addEventListener("error",function(){r(n.error)}),n.readAsBinaryString(e)})}},P={file:C.file,filelist:{test:e=>"FileList"===u.toStringTag(e),replace(e){const t=[];for(let r=0;r<e.length;r++)t[r]=e.item(r);return t},revive(e){return new class FileList{constructor(){this._files=arguments[0],this.length=this._files.length}item(e){return this._files[e]}get[Symbol.toStringTag](){return"FileList"}}(e)}}},x={imagebitmap:{test:e=>"ImageBitmap"===u.toStringTag(e)||e&&e.dataset&&"ImageBitmap"===e.dataset.toStringTag,replace(e){const t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive(e){const t=document.createElement("canvas"),r=t.getContext("2d"),n=document.createElement("img");return n.addEventListener("load",function(){r.drawImage(n,0,0)}),n.src=e,t},reviveAsync(e){const t=document.createElement("canvas"),r=t.getContext("2d"),n=document.createElement("img");return n.addEventListener("load",function(){r.drawImage(n,0,0)}),n.src=e,createImageBitmap(t)}}},I={imagedata:{test:e=>"ImageData"===u.toStringTag(e),replace:e=>({array:[...e.data],width:e.width,height:e.height}),revive:e=>new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}},E={infinity:{test:e=>e===1/0,replace:e=>"Infinity",revive:e=>1/0}},k={IntlCollator:{test:e=>u.hasConstructorOf(e,Intl.Collator),replace:e=>e.resolvedOptions(),revive:e=>new Intl.Collator(e.locale,e)},IntlDateTimeFormat:{test:e=>u.hasConstructorOf(e,Intl.DateTimeFormat),replace:e=>e.resolvedOptions(),revive:e=>new Intl.DateTimeFormat(e.locale,e)},IntlNumberFormat:{test:e=>u.hasConstructorOf(e,Intl.NumberFormat),replace:e=>e.resolvedOptions(),revive:e=>new Intl.NumberFormat(e.locale,e)}},B={map:{test:e=>"Map"===u.toStringTag(e),replace:e=>[...e.entries()],revive:e=>new Map(e)}},N={nan:{test:e=>"number"==typeof e&&isNaN(e),replace:e=>"NaN",revive:e=>NaN}},U={negativeInfinity:{test:e=>e===-1/0,replace:e=>"-Infinity",revive:e=>-1/0}},K={nonbuiltinIgnore:{test:e=>e&&"object"==typeof e&&!Array.isArray(e)&&!["Object","Boolean","Number","String","Error","RegExp","Math","Date","Map","Set","JSON","ArrayBuffer","SharedArrayBuffer","DataView","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","Promise","String Iterator","Array Iterator","Map Iterator","Set Iterator","WeakMap","WeakSet","Atomics","Module"].includes(u.toStringTag(e)),replace(e){}}},L={StringObject:{test:e=>"String"===u.toStringTag(e)&&"object"==typeof e,replace:e=>String(e),revive:e=>new String(e)},BooleanObject:{test:e=>"Boolean"===u.toStringTag(e)&&"object"==typeof e,replace:e=>Boolean(e),revive:e=>new Boolean(e)},NumberObject:{test:e=>"Number"===u.toStringTag(e)&&"object"==typeof e,replace:e=>Number(e),revive:e=>new Number(e)}},D={regexp:{test:e=>"RegExp"===u.toStringTag(e),replace:e=>({source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}),revive:({source:e,flags:t})=>new RegExp(e,t)}},M={},F={resurrectable:{test:e=>e&&!Array.isArray(e)&&["object","function","symbol"].includes(typeof e),replace(e){const t=generateUUID();return M[t]=e,t},revive:e=>M[e]}},$={set:{test:e=>"Set"===u.toStringTag(e),replace:e=>[...e.values()],revive:e=>new Set(e)}},J="undefined"==typeof self?global:self,G={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){const t=e,r=J[e];r&&(G[e.toLowerCase()]={test:e=>u.toStringTag(e)===t,replace:e=>(0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e:e.slice(0)).buffer,revive:e=>"ArrayBuffer"===u.toStringTag(e)?new r(e):e})});const q="undefined"==typeof self?global:self,W={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(e){const t=e,r=q[t];r&&(W[e.toLowerCase()]={test:e=>u.toStringTag(e)===t,replace({buffer:e,byteOffset:t,length:r},n){n.buffers||(n.buffers=[]);const a=n.buffers.indexOf(e);return a>-1?{index:a,byteOffset:t,length:r}:(n.buffers.push(e),{encoded:v(e),byteOffset:t,length:r})},revive(e,t){t.buffers||(t.buffers=[]);const{byteOffset:n,length:a,encoded:i,index:o}=e;let s;return"index"in e?s=t.buffers[o]:(s=d(i),t.buffers.push(s)),new r(s,n,a)}})});const V={undef:{test:(e,t)=>void 0===e&&(t.ownKeys||!("ownKeys"in t)),replace:e=>0,revive:e=>new u.Undefined}},H={userObject:{test:(e,t)=>u.isUserObject(e),replace:e=>({...e}),revive:e=>e}},X=[{arrayNonindexKeys:{testPlainObjects:!0,test:(e,t)=>!!Array.isArray(e)&&(Object.keys(e).some(e=>String(parseInt(e))!==e)&&(t.iterateIn="object",t.addLength=!0),!0),replace:(e,t)=>(Array.isArray(e)&&(t.iterateUnsetNumeric=!0),e),revive(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach(r=>{const n=e[r];t[r]=n}),t}}},{sparseUndefined:{test:(e,t)=>void 0===e&&!1===t.ownKeys,replace:e=>0,revive(e){}}}],Y=[N,E,U],z=[V,X,L,Y,A,T,_,D].concat("function"==typeof Map?B:[],"function"==typeof Set?$:[],"function"==typeof ArrayBuffer?h:[],"function"==typeof Uint8Array?W:[],"function"==typeof DataView?S:[],"undefined"!=typeof Intl?k:[],"undefined"!=typeof BigInt?[g,b]:[]),Q=[T,_],Z=[z,{ArrayBuffer:null},G],ee=[{sparseArrays:{testPlainObjects:!0,test:e=>Array.isArray(e),replace:(e,t)=>(t.iterateUnsetNumeric=!0,e)}},{sparseUndefined:{test:(e,t)=>void 0===e&&!1===t.ownKeys,replace:e=>0,revive(e){}}}],te=[H,V,X,L,Y,A,D,I,x,C,P,m].concat("function"==typeof Map?B:[],"function"==typeof Set?$:[],"function"==typeof ArrayBuffer?h:[],"function"==typeof Uint8Array?W:[],"function"==typeof DataView?S:[],"undefined"!=typeof Intl?k:[],"undefined"!=typeof BigInt?[g,b]:[]);var re=te.concat({checkDataCloneException:[function(e){const t={}.toString.call(e).slice(8,-1);if(["symbol","function"].includes(typeof e)||["Arguments","Module","Error","Promise","WeakMap","WeakSet","Event","MessageChannel"].includes(t)||e===Object.prototype||("Blob"===t||"File"===t)&&e.isClosed||e&&"object"==typeof e&&"number"==typeof e.nodeType&&"function"==typeof e.insertBefore)throw new DOMException("The object cannot be cloned.","DataCloneError");return!1}]});const ne=[ee,V],ae=[z];u.types={arraybuffer:h,bigintObject:b,bigint:g,blob:m,cloneable:w,dataview:S,date:A,error:T,errors:_,file:C,filelist:P,imagebitmap:x,imagedata:I,infinity:E,intlTypes:k,map:B,nan:N,negativeInfinity:U,nonbuiltinIgnore:K,primitiveObjects:L,regexp:D,resurrectable:F,set:$,typedArraysSocketio:G,typedArrays:W,undef:V,userObject:H},u.presets={arrayNonindexKeys:X,builtin:z,postmessage:Q,socketio:Z,sparseUndefined:ee,specialNumbers:Y,structuredCloningThrowing:re,structuredCloning:te,undef:ne,universal:ae};export default u;
//# sourceMappingURL=index.js.map
